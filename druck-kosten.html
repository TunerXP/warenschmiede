<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>3D-Druck-Kosten berechnen – Schnellrechner</title>
  <meta name="description" content="3D-Druck Kosten berechnen: Material, Energie und Nacharbeit im Schnellrechner kalkulieren – inklusive Tipps zur Preisfindung.">
  <meta name="keywords" content="3D Druck Kostenrechner, 3D Druck Kosten, Filament kalkulieren, Energieverbrauch 3D Druck, Nachbearbeitung Kosten, Preisfindung 3D Druck">
  <meta name="geo.region" content="DE-BW">
  <meta name="geo.placename" content="Donaueschingen">
  <meta name="geo.position" content="47.953;8.499">
  <meta name="ICBM" content="47.953,8.499">
  <link rel="icon" href="assets/logo.svg" type="image/svg+xml">
  <link rel="preload" as="image" href="assets/logo.svg">
  <script>
    (function () {
      var storageKey = 'theme-preference';
      var preference = 'system';
      try {
        var stored = localStorage.getItem(storageKey);
        if (stored === 'light' || stored === 'dark' || stored === 'system') {
          preference = stored;
        }
      } catch (error) {}
      var mediaQuery = window.matchMedia ? window.matchMedia('(prefers-color-scheme: dark)') : null;
      var resolved = preference === 'dark'
        ? 'dark'
        : preference === 'light'
          ? 'light'
          : (mediaQuery && mediaQuery.matches ? 'dark' : 'light');
      var root = document.documentElement;
      root.dataset.theme = resolved;
      root.dataset.themePreference = preference;
    })();
  </script>
  <link rel="stylesheet" href="styles.css">
  <meta name="robots" content="index,follow">
  <meta name="theme-color" content="#0d1117">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f8fafc">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#0d1117">
  <meta name="color-scheme" content="light dark">
  <link rel="canonical" href="https://www.warenschmiede.com/druck-kosten.html">
  <meta property="og:title" content="3D-Druck-Kosten berechnen – Schnellrechner">
  <meta property="og:description" content="3D-Druck Kosten berechnen: Material, Energie und Nacharbeit im Schnellrechner kalkulieren – inklusive Tipps zur Preisfindung.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://www.warenschmiede.com/druck-kosten.html">
  <meta property="og:image" content="/assets/og/og-default.jpg">
  <meta property="og:site_name" content="Warenschmiede">
  <meta property="og:locale" content="de_DE">
  <meta name="twitter:card" content="summary_large_image">
</head>
<body>
  <header class="site-header no-print" data-header>
    <div class="container header-grid">
      <div class="brand">
        <a class="brand-link" href="/index.html#start">
          <img src="assets/images/warenschmiede_logo.png" alt="Warenschmiede Logo" class="brand-logo" width="453" height="276" fetchpriority="high">
          <div class="brand-text">
            <span class="brand-name">Warenschmiede</span>
            <span class="brand-tagline">3D-Druck · Made in Germany</span>
          </div>
        </a>
      </div>

      <nav class="main-nav" aria-label="Hauptnavigation">
        <div class="nav-menu" id="primary-navigation" data-nav-menu>
          <ul class="nav-list" id="navList">
            <li class="nav-item nav-fixed">
              <a class="nav-link" href="/index.html#start" data-nav-link data-section="start" data-path="/ , /index.html , /warenschmiede/ , /warenschmiede/index.html"><span class="nav-ico" aria-hidden="true">🏠</span>Start</a>
            </li>
            <li class="nav-item nav-fixed nav-more nav-dropdown nav-services" data-nav-dropdown>
              <button class="nav-more-btn" type="button" aria-haspopup="true" aria-expanded="false"><span class="nav-ico" aria-hidden="true">🧰</span>Leistungen ▾</button>
              <ul class="nav-more-menu" hidden>
                <li>
                  <a class="nav-link" href="/leistungen/3d-druck.html" data-nav-link data-path="/leistungen/3d-druck , /leistungen/3d-druck.html"><span class="nav-ico" aria-hidden="true">📦</span>3D-Druckauftrag</a>
                </li>
                <li>
                  <a class="nav-link" href="/leistungen/cad-prototyping.html" data-nav-link data-path="/leistungen/cad-prototyping , /leistungen/cad-prototyping.html"><span class="nav-ico" aria-hidden="true">📐</span>CAD &amp; Prototyping</a>
                </li>
                <li>
                  <a class="nav-link" href="/leistungen/pc-hilfe.html" data-nav-link data-path="/leistungen/pc-hilfe , /leistungen/pc-hilfe.html"><span class="nav-ico" aria-hidden="true">💻</span>PC-Hilfe</a>
                </li>
              </ul>
            </li>
            <li class="nav-item nav-fixed nav-more nav-dropdown" data-nav-dropdown>
              <button class="nav-more-btn" type="button" aria-haspopup="true" aria-expanded="false"><span class="nav-ico" aria-hidden="true">🤖</span>Über KI ▾</button>
              <ul class="nav-more-menu" hidden>
                <li>
                  <a class="nav-link" href="/ki/index.html" data-nav-link data-path="/ki , /ki/ , /ki/index.html"><span class="nav-ico" aria-hidden="true">📖</span>Einführung &amp; Grundlagen</a>
                </li>
                <li>
                  <a class="nav-link" href="/ki/prompts.html" data-nav-link data-path="/ki/prompts , /ki/prompts.html"><span class="nav-ico" aria-hidden="true">✍️</span>Prompts für den Alltag</a>
                </li>
                <li>
                  <a class="nav-link" href="/ki/tools.html" data-nav-link data-path="/ki/tools , /ki/tools.html"><span class="nav-ico" aria-hidden="true">🛠️</span>KI-Werkzeuge</a>
                </li>
                <li>
                  <a class="nav-link" href="/ki/faq.html" data-nav-link data-path="/ki/faq , /ki/faq.html"><span class="nav-ico" aria-hidden="true">🔒</span>KI-FAQ &amp; Sicherheit</a>
                </li>
                <li>
                  <a class="nav-link" href="/ki/lexikon.html" data-nav-link data-path="/ki/lexikon , /ki/lexikon.html"><span class="nav-ico" aria-hidden="true">🔤</span>KI-Lexikon</a>
                </li>
              </ul>
            </li>
            <li class="nav-item nav-fixed nav-more nav-dropdown nav-contact" data-nav-dropdown>
              <button class="nav-more-btn" type="button" aria-haspopup="true" aria-expanded="false"><span class="nav-ico" aria-hidden="true">✉️</span>Kontakt ▾</button>
              <ul class="nav-more-menu" hidden>
                <li>
                  <a class="nav-link" href="/kontakt.html" data-nav-link data-path="/kontakt , /kontakt.html , /warenschmiede/kontakt , /warenschmiede/kontakt.html"><span class="nav-ico" aria-hidden="true">📧</span>Kontakt aufnehmen</a>
                </li>
                <li>
                  <a class="nav-link" href="/ueber-mich.html" data-nav-link data-path="/ueber-mich , /ueber-mich.html , /warenschmiede/ueber-mich.html , /about , /about.html , /warenschmiede/about.html"><span class="nav-ico" aria-hidden="true">👤</span>Über mich</a>
                </li>
              </ul>
            </li>
            <li class="nav-item nav-fixed nav-more nav-dropdown nav-3d" data-nav-dropdown>
              <button class="nav-more-btn" type="button" aria-haspopup="true" aria-expanded="false"><span class="nav-ico" aria-hidden="true">📦</span>3D-Druck ▾</button>
              <ul class="nav-more-menu" hidden>
                <li>
                  <a class="nav-link" href="/ideenquellen.html" data-nav-link data-path="/ideenquellen , /ideenquellen.html , /ideen , /ideen/ , /ideen/index.html"><span class="nav-ico" aria-hidden="true">💡</span>Ideenquellen &amp; Portale</a>
                </li>
                <li>
                  <a class="nav-link" href="/material.html" data-nav-link data-path="/material.html , /material , /material/ , /material/index.html , /materials , /materials/ , /materials/index.html"><span class="nav-ico" aria-hidden="true">📚</span>Materialwissen &amp; Vergleiche</a>
                </li>
                <li>
                  <a class="nav-link" href="/druck-tipps.html" data-nav-link data-path="/druck-tipps , /druck-tipps.html"><span class="nav-ico" aria-hidden="true">🧭</span>Tipps &amp; Abläufe / Kosten</a>
                </li>
                <li>
                  <a class="nav-link" href="/druck-kosten.html" data-nav-link data-path="/druck-kosten , /druck-kosten.html"><span class="nav-ico" aria-hidden="true">🧮</span>Kosten &amp; Kalkulation</a>
                </li>
                <li>
                  <a class="nav-link" href="/ablauf-anfrage.html" data-nav-link data-path="/ablauf-anfrage , /ablauf-anfrage.html"><span class="nav-ico" aria-hidden="true">📝</span>Ablauf &amp; Anfrage</a>
                </li>
                <li>
                  <a class="nav-link" href="/slicer-einstellungen.html" data-nav-link data-path="/slicer-einstellungen , /slicer-einstellungen.html"><span class="nav-ico" aria-hidden="true">⚙️</span>Slicer &amp; Einstellungen</a>
                </li>
                <li>
                  <a class="nav-link" href="/3ddruck-faq.html" data-nav-link data-path="/3ddruck-faq , /3ddruck-faq.html"><span class="nav-ico" aria-hidden="true">❓</span>FAQ &amp; Einstieg</a>
                </li>
                <li>
                  <a class="nav-link" href="/wartung-reinigung.html" data-nav-link data-path="/wartung-reinigung , /wartung-reinigung.html"><span class="nav-ico" aria-hidden="true">🧼</span>Wartung &amp; Reinigung</a>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>

      <div class="header-actions">
        <button class="theme-toggle" type="button" id="themeToggleBtn" aria-label="Theme wechseln" title="Theme wechseln">
          <span id="themeIcon" aria-hidden="true">🖥️</span>
          <span class="sr-only theme-toggle__label">Aktuelles Theme: Systemeinstellung</span>
        </button>

        <button class="nav-toggle" type="button" aria-controls="primary-navigation" aria-expanded="false" data-nav-toggle>
          <span class="sr-only">Menü öffnen</span>
          <span class="nav-toggle-bar" aria-hidden="true"></span>
          <span class="nav-toggle-bar" aria-hidden="true"></span>
          <span class="nav-toggle-bar" aria-hidden="true"></span>
        </button>
      </div>
    </div>
  </header>

  <nav class="breadcrumbs no-print" aria-label="Brotkrumen">
    <div class="container breadcrumbs__container">
      <ol class="breadcrumbs__list">
        <li class="breadcrumbs__item"><a href="/index.html">Start</a></li>
        <li class="breadcrumbs__item"><a href="/leistungen/3d-druck.html">3D-Druck</a></li>
        <li class="breadcrumbs__item" aria-current="page"><span class="nav-ico" aria-hidden="true">🧮</span>Kosten & Kalkulation</li>
      </ol>
    </div>
  </nav>

  <main id="druck-kosten" class="site-main no-print" tabindex="-1">
    <section class="section about-hero" aria-labelledby="kosten-heading">
      <div class="container about-hero__grid">
        <div class="about-hero__content">
          <p class="section-eyebrow">Kosten &amp; Kalkulation</p>
          <h1 id="kosten-heading">3D-Druck-Kosten grob einschätzen</h1>
          <p>Mit diesem Rechner bekommst du eine unverbindliche Hausnummer für Material- und Energiekosten – ideal für die erste Planung vor dem Angebot.</p>
          <div class="hero-actions">
            <a class="btn btn-primary" href="#calcForm">Kosten berechnen</a>
            <a class="btn btn-outline" href="/kontakt.html#kontakt-heading">Projekt anfragen</a>
          </div>
        </div>
      </div>
    </section>

    <section class="section" aria-labelledby="rechner-heading">
      <div class="container">
        <div class="section-heading">
          <h2 id="rechner-heading">Kostenrechner für Filamentdruck</h2>
          <p>Wähle Material, gib Gewicht oder Länge ein und ergänze Laufzeit sowie Stromkosten – der Rest passiert automatisch.</p>
        </div>
        <div class="cost-layout">
          <div class="card" id="calculatorCard">
            <h2 class="calc-card__title">Formular</h2>
            <form class="calc-form" id="calcForm" novalidate>
              <div id="std-fields">
                <div class="calc-pro-toggle">
                  <label class="calc-toggle">
                    <input class="calc-toggle__input" type="checkbox" id="proToggle" name="proToggle" aria-controls="pro-fields" aria-expanded="false">
                    <span class="calc-toggle__track" aria-hidden="true">
                      <span class="calc-toggle__thumb"></span>
                    </span>
                    <span class="calc-toggle__text">
                      <span class="calc-toggle__title">Erweiterter Rechner</span>
                      <span class="calc-toggle__hint">Zusatzfelder für Marge, Zeiten &amp; Rabatt</span>
                    </span>
                  </label>
                </div>

                <div class="calc-field">
                  <label for="materialSelect">Material</label>
                  <select id="materialSelect" name="material">
                    <option value="PLA">PLA</option>
                    <option value="PLA_PLUS">PLA+</option>
                    <option value="PLA_SILK">PLA Silk</option>
                    <option value="PETG">PETG</option>
                    <option value="PETG_CF">PETG-CF</option>
                    <option value="ABS">ABS</option>
                    <option value="ABS_CF">ABS-CF</option>
                    <option value="ASA">ASA</option>
                    <option value="ASA_CF">ASA-CF</option>
                    <option value="TPU">TPU</option>
                    <option value="PA">Nylon (PA)</option>
                  </select>
                  <p class="calc-hint" id="materialDensityHint" aria-live="polite">Richtwert: 2,98&nbsp;g/m (PLA)</p>
                </div>

                <div class="calc-field">
                  <label for="pricePerKg">Materialpreis (€/kg)</label>
                  <div class="calc-price-input-row">
                    <input class="calc-price-input" type="number" id="pricePerKg" name="pricePerKg" min="0" step="0.10" inputmode="decimal" placeholder="z. B. 20">
                    <button type="button" class="calc-price-suggestion is-hidden" id="priceSuggestionButton">
                      Vorschlag einsetzen
                      <span class="sr-only" id="priceSuggestionSrText"></span>
                    </button>
                  </div>
                </div>

                <fieldset class="calc-fieldset">
                  <legend class="sr-only">Berechnungsgrundlage</legend>
                  <div class="calc-mode" role="group" aria-label="Berechnungsgrundlage wählen">
                    <div>
                      <input class="calc-mode__input" type="radio" id="modeWeight" name="mode" value="weight" checked>
                      <label class="calc-mode__label" for="modeWeight">Bauteilgewicht</label>
                    </div>
                    <div>
                      <input class="calc-mode__input" type="radio" id="modeLength" name="mode" value="length">
                      <label class="calc-mode__label" for="modeLength">Filamentlänge</label>
                    </div>
                  </div>
                  <div class="calc-field" data-field="weight">
                    <label for="partWeight">Materialgewicht (g)</label>
                    <input type="number" id="partWeight" name="partWeight" min="0" step="1" inputmode="decimal" placeholder="z. B. 200">
                  </div>
                  <div class="calc-field" data-field="length" hidden>
                    <label for="filamentLength">Filamentlänge in Metern</label>
                    <input type="number" id="filamentLength" name="filamentLength" min="0" step="0.1" inputmode="decimal" placeholder="z. B. 32">
                  </div>
                </fieldset>

                <div class="calc-field">
                  <label for="wastePercent">Verschnitt (%)</label>
                  <input type="number" id="wastePercent" name="wastePercent" min="0" max="100" step="1" inputmode="decimal" placeholder="z. B. 10">
                </div>

                <div class="calc-inline">
                  <div class="calc-field">
                    <label for="printTime">Druckzeit (hh:mm)</label>
                    <input type="time" id="printTime" name="printTime" step="60" placeholder="05:00">
                  </div>
                  <div class="calc-field">
                    <label for="powerDraw">Leistung (W)</label>
                    <input type="number" id="powerDraw" name="powerDraw" min="0" step="10" placeholder="z. B. 150">
                    <p class="calc-hint">Wird erst berücksichtigt, wenn du einen Wert eingibst.</p>
                  </div>
                  <div class="calc-field">
                  <label for="energyPrice">Strompreis (€/kWh)</label>
                    <input type="number" id="energyPrice" name="energyPrice" min="0" step="0.01" inputmode="decimal" placeholder="z. B. 0,30">
                    <p class="calc-hint">Wird erst berücksichtigt, wenn du einen Wert eingibst.</p>
                  </div>
                  <div class="calc-field">
                  <label for="loadFactor">Lastfaktor (%)</label>
                    <input type="number" id="loadFactor" name="loadFactor" min="0" max="100" step="1" placeholder="z. B. 80">
                    <p class="calc-hint">Wird erst berücksichtigt, wenn du einen Wert eingibst.</p>
                  </div>
                </div>
              </div>

              <section class="calc-pro" id="pro-fields" hidden aria-hidden="true" inert>
                <p class="calc-hint calc-hint--lead">Nutze die Zusatzfelder für Marge, Arbeitszeit und optionale Abschläge.</p>
                <div class="calc-pro__grid">
                  <div class="calc-field">
                  <label for="profitMargin">Gewinnmarge (%)</label>
                    <input type="number" id="profitMargin" name="profitMargin" min="0" max="100" step="0.5" inputmode="decimal" placeholder="z. B. 10">
                  </div>
                  <div class="calc-field">
                  <label for="hourlyRate">Stundenlohn (€/h)</label>
                    <input type="number" id="hourlyRate" name="hourlyRate" min="0" step="1" inputmode="decimal" placeholder="z. B. 20">
                  </div>
                  <div class="calc-field">
                  <label for="setupMinutes">Rüstzeit (min)</label>
                    <input type="number" id="setupMinutes" name="setupMinutes" min="0" step="1" inputmode="decimal" placeholder="z. B. 10">
                  </div>
                  <div class="calc-field">
                    <label for="proPrintMinutes">Druckzeit (min)</label>
                    <input type="number" id="proPrintMinutes" name="proPrintMinutes" min="0" step="1" inputmode="decimal" aria-describedby="hint-printMinutes">
                    <p class="calc-hint" id="hint-printMinutes">Synchronisiert mit der Laufzeit oben.</p>
                  </div>
                  <div class="calc-field">
                  <label for="finishingMinutes">Nachbearbeitung (min)</label>
                    <input type="number" id="finishingMinutes" name="finishingMinutes" min="0" step="1" inputmode="decimal" placeholder="z. B. 10">
                  </div>
                  <div class="calc-field">
                  <label for="fixedCost">Fixkosten (€)</label>
                    <input type="number" id="fixedCost" name="fixedCost" min="0" step="0.5" inputmode="decimal" placeholder="z. B. 5">
                  </div>
                  <div class="calc-field">
                  <label for="discountPercent">Rabatt (%)</label>
                    <input type="number" id="discountPercent" name="discountPercent" min="0" max="100" step="0.5" inputmode="decimal" placeholder="z. B. 0">
                  </div>
                </div>
              </section>
            </form>
          </div>

          <div class="card calc-results" aria-live="polite">
            <div class="calc-results__header">
              <h2>Ergebnis</h2>
              <p class="calc-meta" id="calcMeta">Gewicht: 0&nbsp;g · Länge: 0,00&nbsp;m</p>
            </div>
            <div class="calc-results__actions">
              <button type="button" class="btn btn-outline" id="printResultButton">Ergebnis drucken</button>
              <button type="button" class="btn btn-outline" id="printFullButton">Ergebnis + Eingaben drucken</button>
            </div>
            <label class="calc-checkbox calc-checkbox--vat" for="includeVat">
              <input type="checkbox" id="includeVat" name="includeVat" value="true">
              <span>Preise inkl. MwSt.</span>
            </label>
            <ul class="calc-results__list">
              <li class="calc-results__item">
                <span class="calc-results__label" id="materialCostLabel">Material (Basis)</span>
                <span class="calc-results__value" id="materialCost">0,00&nbsp;€</span>
              </li>
              <li class="calc-results__item" data-result="materialWaste">
                <span class="calc-results__label">Verschnitt</span>
                <span class="calc-results__value" id="materialWasteCost">0,00&nbsp;€</span>
              </li>
              <li class="calc-results__item" data-result="materialTotal">
                <span class="calc-results__label">Material (inkl. Verschnitt)</span>
                <span class="calc-results__value" id="materialTotalCost">0,00&nbsp;€</span>
              </li>
              <li class="calc-results__item">
                <span class="calc-results__label" id="energyCostLabel">Energiekosten</span>
                <span class="calc-results__value" id="energyCost">0,00&nbsp;€</span>
              </li>
              <li class="calc-results__item calc-results__item--pro" data-result="timeCost" data-pro-row="true" hidden>
                <span class="calc-results__label">Arbeitszeitkosten (Rüstzeit + Nachbearbeitung)</span>
                <span class="calc-results__value" id="timeCost">0,00&nbsp;€</span>
              </li>
              <li class="calc-results__item calc-results__item--pro" data-result="fixedCost" data-pro-row="true" hidden>
                <span class="calc-results__label">Fixkosten</span>
                <span class="calc-results__value" id="fixedCostValue">0,00&nbsp;€</span>
              </li>
              <li class="calc-results__item" data-result="subtotal">
                <span class="calc-results__label">Zwischensumme</span>
                <span class="calc-results__value" id="subtotalValue">0,00&nbsp;€</span>
              </li>
              <li class="calc-results__item calc-results__item--pro" data-result="margin" data-pro-row="true" hidden>
                <span class="calc-results__label">Marge</span>
                <span class="calc-results__value" id="marginValue">0,00&nbsp;€</span>
              </li>
              <li class="calc-results__item calc-results__item--pro" data-result="discount" data-pro-row="true" hidden>
                <span class="calc-results__label">Rabatt</span>
                <span class="calc-results__value calc-results__value--deduction" id="discountValue">0,00&nbsp;€</span>
              </li>
              <li class="calc-results__item">
                <span class="calc-results__label">Gesamtkosten (netto)</span>
                <span class="calc-results__value calc-results__value--accent" id="totalNet">0,00&nbsp;€</span>
              </li>
              <li class="calc-results__item">
                <span class="calc-results__label" id="grossLabel">Gesamtkosten (brutto)</span>
                <span class="calc-results__value" id="totalGross">0,00&nbsp;€</span>
              </li>
            </ul>
            <p class="calc-results__pro-hint" id="proStatus" data-pro-row="true" hidden>Erweiterter Rechner aktiv – Zusatzposten &amp; Fixkosten werden separat ausgewiesen.</p>
            <h3 class="calc-results__subheading">Disclaimer</h3>
            <p class="calc-formula">Energiekosten = (Watt/1000) × Laufzeit × €/kWh × Lastfaktor (Schätzung).</p>
            <p class="calc-note">Unverbindliche Orientierung ohne Design- oder Nachbearbeitungskosten. Tatsächliche Kosten können abweichen.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="section" aria-labelledby="guide-heading">
      <div class="container">
        <div class="card">
          <h2 id="guide-heading">Was macht der Kostenrechner?</h2>
          <p>Der Warenschmiede-Rechner schätzt die Herstellungskosten für FDM-3D-Drucke. Er berücksichtigt Material, Energie und – im Erweiterten Modus – Arbeitszeit, Fixkosten, Marge und Rabatt. Ergebnis: Netto und Brutto/&sect;19 UStG (Kleinunternehmer).</p>

          <h3 id="standard-guide">So gehst du vor &ndash; Standard</h3>
          <ol>
            <li>Material wählen (z. B. PLA).</li>
            <li>Materialpreis eintragen (&euro;/kg). Tipp: steht auf der Filamentrolle/Rechnung.</li>
            <li>Entweder Bauteilgewicht (g) oder Filamentlänge (m) angeben.</li>
            <li>Optional: Verschnitt&nbsp;% (Reste, Support).</li>
            <li>Druckzeit, Leistung (W), Strompreis (&euro;/kWh), Lastfaktor&nbsp;% eintragen, um Energiekosten zu berechnen.
              <ul>
                <li>Leistung (W): Typenschild/Netzteil oder Energiekosten-Messgerät.</li>
                <li>Lastfaktor: durchschnittliche Auslastung während des Drucks (z. B. 80&nbsp;%).</li>
              </ul>
            </li>
            <li>Ergebnis ansehen oder Ergebnis drucken (A4).</li>
          </ol>

          <h3 id="pro-guide">Erweiterter Modus (Pro)</h3>
          <p>Aktiviere &bdquo;Erweiterter Rechner&ldquo;, wenn du zusätzlich kalkulieren willst:</p>
          <ul>
            <li>Rüstzeit (min): Vorbereitung, Einrichten, Start.</li>
            <li>Nachbearbeitung (min): Entgraten, Reinigen, Montage.</li>
            <li>Stundenlohn (&euro;/h): wirkt nur auf Rüstzeit + Nachbearbeitung.</li>
            <li>Fixkosten (&euro;): feste Kosten pro Auftrag (Verpackung, Abschreibung, Versandpauschale &hellip;).</li>
            <li>Gewinnmarge (%): Aufschlag auf variable Kosten (Material + Energie + Arbeitszeit). Fixkosten bleiben fix.</li>
            <li>Rabatt (%): optionaler Abzug vor MwSt.</li>
          </ul>
          <p>Nutze anschließend &bdquo;Ergebnis + Eingaben drucken&ldquo; (2 Seiten: Ergebnis + Eingaben).</p>

          <h3 id="limits-guide">Hinweise &amp; Grenzen</h3>
          <ul>
            <li>Werte sind Schätzungen; tatsächliche Kosten können abweichen (Geometrie, Support, Oberfläche).</li>
            <li>Für ASA/ABS empfehlen wir ein geschlossenes Gehäuse (konstante Bedingungen).</li>
            <li>Für lange Drucke ist ein Energiekosten-Messgerät sinnvoll.</li>
          </ul>
        </div>
      </div>
    </section>

    <section class="section" aria-labelledby="features-heading">
      <div class="container">
        <div class="card card--narrow">
          <h2 id="features-heading">Funktionen erklärt</h2>
          <dl class="calc-feature-list">
            <dt>Material</dt>
            <dd>Wähle das Filament (z. B. PLA, PETG, ASA, Nylon). Die Auswahl setzt – falls leer – einen Richtwert für den Materialpreis.</dd>

            <dt>Materialpreis (€/kg)</dt>
            <dd>Preis der Filamentrolle pro Kilogramm. Wert steht auf der Rolle/Rechnung und ist frei änderbar.</dd>

            <dt>Bauteilgewicht (g) / Filamentlänge (m)</dt>
            <dd>Gib entweder das Bauteilgewicht oder die entsprechende Filamentlänge an. Das Gewicht kannst du im Slicer (z. B. Bambu Studio) ablesen.</dd>

            <dt>Verschnitt (%)</dt>
            <dd>Anteil für Reste, Brim/Skirt, Stützstrukturen. Typisch 5–15 %.</dd>

            <dt>Druckzeit (hh:mm)</dt>
            <dd>Geplante Laufzeit des Drucks. Nimm die Slicer-Schätzung.</dd>

            <dt>Leistung (W)</dt>
            <dd>
              <p>Elektrische Leistungsaufnahme deines Druckers.</p>
              <p><strong>So ermittelst du sie:</strong> Typenschild/Netzteil ablesen oder mit einem Energiekosten-Messgerät messen.</p>
            </dd>

            <dt>Strompreis (€/kWh)</dt>
            <dd>Aktueller Tarif deines Anbieters.</dd>

            <dt>Lastfaktor (%)</dt>
            <dd>Durchschnittliche Auslastung während des Drucks (nicht immer 100 %). Beispiel: 80 % bedeutet, dass Heizung/Lüfter/Bewegung im Mittel bei 0,8×Leistung laufen.</dd>
          </dl>

          <h3>Erweiterter Rechner (optional)</h3>
          <p>Zusatzfelder für professionelle Kalkulation. Wirken nur, wenn der Schalter aktiv ist:</p>
          <ul>
            <li>Rüstzeit (min): Vorbereitung, Einrichtung, Start.</li>
            <li>Nachbearbeitung (min): Support entfernen, Entgraten, Finish.</li>
            <li>Stundenlohn (€/h): Eigen-/Kalkulationslohn für Rüstzeit + Nachbearbeitung (wirkt nur auf diese beiden Zeiten).</li>
            <li>Fixkosten (€): Feste Kosten pro Auftrag (z. B. Verpackung, Abschreibung, Versandpauschale). Bleiben fix – werden nicht durch Marge erhöht.</li>
            <li>Gewinnmarge (%): Aufschlag auf variable Kosten (Material + Energie + Arbeitszeit).</li>
            <li>Rabatt (%): Optionaler Abzug vor MwSt.</li>
          </ul>

          <h3>Ergebnisfelder</h3>
          <ul>
            <li>Material (Basis) + Verschnitt → Material (inkl. Verschnitt)</li>
            <li>Energiekosten = (Watt/1000) × Laufzeit × €/kWh × Lastfaktor</li>
            <li>Arbeitszeitkosten = (Rüstzeit + Nachbearbeitung) × (Stundenlohn/60)</li>
            <li>Zwischensumme = Material inkl. Verschnitt + Energie + Arbeitszeit</li>
            <li>Marge/Rabatt/Fixkosten gemäß Eingaben</li>
            <li>Gesamtkosten (netto) und Brutto (bei § 19 UStG ohne MwSt.)</li>
          </ul>

          <h3>Drucken / Speichern</h3>
          <p>Ergebnis drucken: 1 Seite mit der Aufschlüsselung.</p>
          <p>Ergebnis + Eingaben drucken: 2 Seiten (Ergebnis + deine Eingaben). Die Druckansicht ist für A4 optimiert.</p>
        </div>
      </div>
    </section>

    <section class="section" aria-labelledby="cta-kosten-heading">
      <div class="container">
        <div class="card">
          <h2 id="cta-kosten-heading">Weiter planen &amp; anfragen</h2>
          <p><a href="/ablauf-anfrage.html">Zum Ablauf &amp; Anfrage</a></p>
          <p><a href="/material.html">Materialwissen &amp; Vergleiche ansehen</a></p>
          <p><a href="/kontakt.html#kontakt-heading">Direkt Kontakt aufnehmen</a></p>
        </div>
      </div>
    </section>

    <nav class="section page-links" aria-label="Weiterführende Seiten">
      <div class="container">
        <p class="page-links__text">Mehr wissen: <a href="/material.html">Materialwissen</a> &middot; <a href="/druck-tipps.html">Tipps &amp; Abläufe</a> &middot; <a href="/slicer-einstellungen.html">Slicer &amp; Einstellungen</a></p>
      </div>
    </nav>
  </main>

  <section class="calc-print print-only" id="printSummary" aria-hidden="true">
    <header class="calc-print__header">
      <p class="calc-print__meta">Warenschmiede · <span id="printUrl">warenschmiede.com</span> · <span id="printTimestamp"></span></p>
      <h1 class="calc-print__title">3D-Druck Rechner – Ergebnis</h1>
    </header>

    <section class="calc-print__section" id="printResult">
      <h2 class="calc-print__heading">Zusammenfassung</h2>
      <p class="calc-print__lead">Endsumme</p>
      <p class="calc-print__total" id="printTotal">0,00&nbsp;€</p>
      <p class="calc-print__note" id="printVatNote">Hinweis: §19 UStG – keine Umsatzsteuer.</p>
      <table class="calc-print__table calc-print__table--summary">
        <tbody>
          <tr>
            <th scope="row" id="printMaterialLabel">Material (Basis)</th>
            <td id="printMaterialCost">0,00&nbsp;€</td>
          </tr>
          <tr data-print="waste">
            <th scope="row">Verschnitt</th>
            <td id="printWasteCost">0,00&nbsp;€</td>
          </tr>
          <tr data-print="materialTotal">
            <th scope="row">Material (inkl. Verschnitt)</th>
            <td id="printMaterialTotal">0,00&nbsp;€</td>
          </tr>
          <tr>
            <th scope="row" id="printEnergyLabel">Energiekosten</th>
            <td id="printEnergyCost">0,00&nbsp;€</td>
          </tr>
          <tr class="print-row-pro" data-print="timeCost" data-pro-row="true" hidden>
            <th scope="row">Arbeitszeitkosten (Rüstzeit + Nachbearbeitung)</th>
            <td id="printTimeCost">0,00&nbsp;€</td>
          </tr>
          <tr class="print-row-pro" data-print="fixedCost" data-pro-row="true" hidden>
            <th scope="row">Fixkosten</th>
            <td id="printFixedCost">0,00&nbsp;€</td>
          </tr>
          <tr data-print="subtotal">
            <th scope="row">Zwischensumme</th>
            <td id="printSubtotal">0,00&nbsp;€</td>
          </tr>
          <tr class="print-row-pro" data-print="margin" data-pro-row="true" hidden>
            <th scope="row">Marge</th>
            <td id="printMargin">0,00&nbsp;€</td>
          </tr>
          <tr class="print-row-pro" data-print="discount" data-pro-row="true" hidden>
            <th scope="row">Rabatt</th>
            <td id="printDiscount">0,00&nbsp;€</td>
          </tr>
          <tr>
            <th scope="row">Gesamtkosten (netto)</th>
            <td id="printNet">0,00&nbsp;€</td>
          </tr>
          <tr>
            <th scope="row">Gesamtkosten (brutto)</th>
            <td id="printGross">0,00&nbsp;€</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section class="calc-print__section" id="printInputs">
      <h2 class="calc-print__heading">Eingaben</h2>
      <table class="calc-print__table">
        <tbody>
          <tr>
            <th scope="row">Material</th>
            <td id="printMaterial">PLA</td>
          </tr>
          <tr>
            <th scope="row">Materialpreis</th>
            <td id="printMaterialPrice">0,00&nbsp;€/kg</td>
          </tr>
          <tr>
            <th scope="row">Berechnungsgrundlage</th>
            <td id="printMode">Bauteilgewicht</td>
          </tr>
          <tr>
            <th scope="row">Bauteilgewicht</th>
            <td id="printWeight">0&nbsp;g</td>
          </tr>
          <tr>
            <th scope="row">Filamentlänge</th>
            <td id="printLength">0,00&nbsp;m</td>
          </tr>
          <tr>
            <th scope="row">Druckzeit</th>
            <td id="printDuration">0&nbsp;min</td>
          </tr>
          <tr>
            <th scope="row">Leistung</th>
            <td id="printPower">0&nbsp;W</td>
          </tr>
          <tr>
            <th scope="row">Strompreis</th>
            <td id="printEnergyPrice">0,00&nbsp;€/kWh</td>
          </tr>
          <tr>
            <th scope="row">Lastfaktor</th>
            <td id="printLoadFactor">0&nbsp;%</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section class="calc-print__section" id="printProParams" data-pro-row="true" hidden>
      <h2 class="calc-print__heading">Erweiterter Rechner – Eingaben</h2>
      <table class="calc-print__table">
        <tbody>
          <tr>
            <th scope="row">Gewinnmarge</th>
            <td id="printProfitMargin">0&nbsp;%</td>
          </tr>
          <tr>
            <th scope="row">Stundenlohn</th>
            <td id="printHourlyRate">0,00&nbsp;€/h</td>
          </tr>
          <tr>
            <th scope="row">Rüstzeit</th>
            <td id="printSetupMinutes">0&nbsp;min</td>
          </tr>
          <tr>
            <th scope="row">Druckzeit (Minuten)</th>
            <td id="printProPrintMinutes">0&nbsp;min</td>
          </tr>
          <tr>
            <th scope="row">Nachbearbeitung</th>
            <td id="printFinishingMinutes">0&nbsp;min</td>
          </tr>
          <tr>
            <th scope="row">Verschnitt</th>
            <td id="printWastePercent">0&nbsp;%</td>
          </tr>
          <tr>
            <th scope="row">Fixkosten pro Auftrag</th>
            <td id="printFixedCostInput">0,00&nbsp;€</td>
          </tr>
          <tr>
            <th scope="row">Rabatt</th>
            <td id="printDiscountPercent">0&nbsp;%</td>
          </tr>
        </tbody>
      </table>
    </section>

    <footer class="calc-print__footer">
      <p>Unverbindliche Kalkulation – Werte können abweichen.</p>
    </footer>
  </section>

    <footer class="footer no-print">
    <div class="container">
      <div class="footer__inner">
        <div class="footer__brand">© 2025 Warenschmiede · Alle Rechte vorbehalten.</div>
        <nav class="footer__links" aria-label="Rechtliches &amp; Kontakt">
          <a href="/index.html#impressum">Impressum</a>
          <a href="/index.html#datenschutz">Datenschutzerklärung</a>
          <a href="/kontakt.html">Kontakt</a>
        </nav>
        <div class="footer__notes">
          <p><strong>Haftung / Nutzung:</strong> Alle Angaben ohne Gewähr – Nutzung auf eigene Verantwortung.</p>
          <p><strong>Cookies:</strong> Diese Website verwendet keine Cookies oder Tracking.</p>
        </div>
      </div>
    </div>
  </footer>

  <script src="assets/js/theme.js" defer></script>
  <script src="assets/js/header.js" defer></script>
  <script src="assets/js/whatsapp.js" defer></script>
  <script>
    (function () {
      var materialSelect = document.getElementById('materialSelect');
      var materialDensityHint = document.getElementById('materialDensityHint');
      var pricePerKgInput = document.getElementById('pricePerKg');
      var priceSuggestionButton = document.getElementById('priceSuggestionButton');
      var priceSuggestionSrText = document.getElementById('priceSuggestionSrText');
      var weightInput = document.getElementById('partWeight');
      var lengthInput = document.getElementById('filamentLength');
      var weightMode = document.getElementById('modeWeight');
      var lengthMode = document.getElementById('modeLength');
      var weightField = document.querySelector('[data-field="weight"]');
      var lengthField = document.querySelector('[data-field="length"]');
      var timeInput = document.getElementById('printTime');
      var powerInput = document.getElementById('powerDraw');
      var energyPriceInput = document.getElementById('energyPrice');
      var loadFactorInput = document.getElementById('loadFactor');
      var vatCheckbox = document.getElementById('includeVat');
      var materialCostOutput = document.getElementById('materialCost');
      var energyCostOutput = document.getElementById('energyCost');
      var totalNetOutput = document.getElementById('totalNet');
      var totalGrossOutput = document.getElementById('totalGross');
      var grossLabelOutput = document.getElementById('grossLabel');
      var metaOutput = document.getElementById('calcMeta');
      var materialCostLabelOutput = document.getElementById('materialCostLabel');
      var energyCostLabelOutput = document.getElementById('energyCostLabel');
      var materialWasteRow = document.querySelector('[data-result="materialWaste"]');
      var materialWasteOutput = document.getElementById('materialWasteCost');
      var materialTotalRow = document.querySelector('[data-result="materialTotal"]');
      var materialTotalOutput = document.getElementById('materialTotalCost');
      var timeCostRow = document.querySelector('[data-result="timeCost"]');
      var timeCostOutput = document.getElementById('timeCost');
      var fixedCostRow = document.querySelector('[data-result="fixedCost"]');
      var fixedCostOutput = document.getElementById('fixedCostValue');
      var subtotalRow = document.querySelector('[data-result="subtotal"]');
      var subtotalOutput = document.getElementById('subtotalValue');
      var marginRow = document.querySelector('[data-result="margin"]');
      var marginOutput = document.getElementById('marginValue');
      var discountRow = document.querySelector('[data-result="discount"]');
      var discountOutput = document.getElementById('discountValue');
      var proStatusOutput = document.getElementById('proStatus');
      var printResultButton = document.getElementById('printResultButton');
      var printFullButton = document.getElementById('printFullButton');
      var proToggle = document.getElementById('proToggle');
      var proFields = document.getElementById('pro-fields');
      var proRows = document.querySelectorAll('[data-pro-row="true"]');
      var rootElement = document.documentElement;
      var profitMarginInput = document.getElementById('profitMargin');
      var hourlyRateInput = document.getElementById('hourlyRate');
      var setupMinutesInput = document.getElementById('setupMinutes');
      var proPrintMinutesInput = document.getElementById('proPrintMinutes');
      var finishingMinutesInput = document.getElementById('finishingMinutes');
      var wastePercentInput = document.getElementById('wastePercent');
      var fixedCostInput = document.getElementById('fixedCost');
      var discountPercentInput = document.getElementById('discountPercent');

      var printMaterialOutput = document.getElementById('printMaterial');
      var printMaterialPriceOutput = document.getElementById('printMaterialPrice');
      var printModeOutput = document.getElementById('printMode');
      var printWeightOutput = document.getElementById('printWeight');
      var printLengthOutput = document.getElementById('printLength');
      var printTimeOutput = document.getElementById('printDuration');
      var printPowerOutput = document.getElementById('printPower');
      var printEnergyPriceOutput = document.getElementById('printEnergyPrice');
      var printLoadFactorOutput = document.getElementById('printLoadFactor');
      var printMaterialLabelOutput = document.getElementById('printMaterialLabel');
      var printMaterialCostOutput = document.getElementById('printMaterialCost');
      var printWasteCostOutput = document.getElementById('printWasteCost');
      var printMaterialTotalOutput = document.getElementById('printMaterialTotal');
      var printEnergyLabelOutput = document.getElementById('printEnergyLabel');
      var printEnergyCostOutput = document.getElementById('printEnergyCost');
      var printTimeCostOutput = document.getElementById('printTimeCost');
      var printFixedCostOutput = document.getElementById('printFixedCost');
      var printSubtotalOutput = document.getElementById('printSubtotal');
      var printMarginOutput = document.getElementById('printMargin');
      var printDiscountOutput = document.getElementById('printDiscount');
      var printNetOutput = document.getElementById('printNet');
      var printGrossOutput = document.getElementById('printGross');
      var printTotalOutput = document.getElementById('printTotal');
      var printVatNoteOutput = document.getElementById('printVatNote');
      var printTimestampOutput = document.getElementById('printTimestamp');
      var printUrlOutput = document.getElementById('printUrl');
      var printProParamsSection = document.getElementById('printProParams');
      var printProfitMarginOutput = document.getElementById('printProfitMargin');
      var printHourlyRateOutput = document.getElementById('printHourlyRate');
      var printSetupMinutesOutput = document.getElementById('printSetupMinutes');
      var printProPrintMinutesOutput = document.getElementById('printProPrintMinutes');
      var printFinishingMinutesOutput = document.getElementById('printFinishingMinutes');
      var printWastePercentOutput = document.getElementById('printWastePercent');
      var printFixedCostInputOutput = document.getElementById('printFixedCostInput');
      var printDiscountPercentOutput = document.getElementById('printDiscountPercent');

      var formatter = new Intl.NumberFormat('de-DE', { style: 'currency', currency: 'EUR' });
      var decimalFormatter = new Intl.NumberFormat('de-DE', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      var integerFormatter = new Intl.NumberFormat('de-DE', { maximumFractionDigits: 0 });
      var percentNumberFormatter = new Intl.NumberFormat('de-DE', { minimumFractionDigits: 0, maximumFractionDigits: 1 });
      var dateTimeFormatter = new Intl.DateTimeFormat('de-DE', { dateStyle: 'short', timeStyle: 'short' });

      function updatePriceSuggestionState(defaults) {
        if (!priceSuggestionButton) {
          return;
        }

        var suggestion = defaults && typeof defaults.price === 'number' && isFinite(defaults.price)
          ? defaults.price
          : null;

        if (suggestion === null) {
          priceSuggestionButton.classList.add('is-hidden');
          priceSuggestionButton.dataset.suggestion = '';
          if (priceSuggestionSrText) {
            priceSuggestionSrText.textContent = '';
          }
          return;
        }

        var formattedSuggestion = decimalFormatter.format(suggestion) + '\u00A0€/kg';
        priceSuggestionButton.dataset.suggestion = suggestion.toString();
        if (priceSuggestionSrText) {
          priceSuggestionSrText.textContent = ' – ' + formattedSuggestion + ' übernehmen';
        }

        var currentValueRaw = pricePerKgInput && pricePerKgInput.value != null
          ? pricePerKgInput.value.toString().trim()
          : '';

        var shouldShow = false;
        if (currentValueRaw) {
          var parsedCurrent = parseFloat(currentValueRaw.replace(',', '.'));
          if (!isFinite(parsedCurrent)) {
            shouldShow = true;
          } else {
            shouldShow = Math.abs(parsedCurrent - suggestion) > 0.001;
          }
        }

        if (shouldShow) {
          priceSuggestionButton.classList.remove('is-hidden');
        } else {
          priceSuggestionButton.classList.add('is-hidden');
        }
      }

      var materialData = {
        'PLA': {
          price: 20,
          gramsPerMeter: 2.98,
          densityHint: 'Richtwert: 2,98\u00A0g/m (PLA)'
        },
        'PLA_PLUS': {
          price: 23,
          gramsPerMeter: 3.05,
          densityHint: 'Richtwert: 3,05\u00A0g/m (PLA+)'
        },
        'PLA_SILK': {
          price: 25,
          gramsPerMeter: 2.90,
          densityHint: 'Richtwert: 2,90\u00A0g/m (PLA Silk)'
        },
        'PETG': {
          price: 25,
          gramsPerMeter: 3.05,
          densityHint: 'Richtwert: 3,05\u00A0g/m (PETG)'
        },
        'PETG_CF': {
          price: 55,
          gramsPerMeter: 3.20,
          densityHint: 'Richtwert: 3,20\u00A0g/m (PETG-CF)'
        },
        'ABS': {
          price: 27,
          gramsPerMeter: 2.65,
          densityHint: 'Richtwert: 2,65\u00A0g/m (ABS)'
        },
        'ABS_CF': {
          price: 58,
          gramsPerMeter: 2.60,
          densityHint: 'Richtwert: 2,60\u00A0g/m (ABS-CF)'
        },
        'ASA': {
          price: 35,
          gramsPerMeter: 2.57,
          densityHint: 'Richtwert: 2,57\u00A0g/m (ASA)'
        },
        'ASA_CF': {
          price: 60,
          gramsPerMeter: 2.70,
          densityHint: 'Richtwert: 2,70\u00A0g/m (ASA-CF)'
        },
        'TPU': {
          price: 30,
          gramsPerMeter: 2.85,
          densityHint: 'Richtwert: 2,85\u00A0g/m (TPU)'
        },
        'PA': {
          price: 45,
          gramsPerMeter: 2.74,
          densityHint: 'Richtwert: 2,74\u00A0g/m (Nylon)'
        }
      };

      var suppressProSync = false;
      var proModeEnabled = false;

      function applyProVisibility(enabled) {
        if (proToggle) {
          proToggle.checked = enabled;
          proToggle.setAttribute('aria-expanded', enabled ? 'true' : 'false');
        }
        if (proFields) {
          proFields.hidden = !enabled;
          proFields.setAttribute('aria-hidden', enabled ? 'false' : 'true');
          if (enabled) {
            proFields.removeAttribute('inert');
          } else {
            proFields.setAttribute('inert', '');
          }
        }
        if (proRows && proRows.length) {
          proRows.forEach(function (row) {
            row.hidden = !enabled;
          });
        }
        if (proStatusOutput) {
          proStatusOutput.hidden = !enabled;
        }
        if (printProParamsSection) {
          printProParamsSection.hidden = !enabled;
        }
        if (rootElement) {
          rootElement.classList.toggle('is-pro-on', enabled);
          rootElement.classList.toggle('is-pro-off', !enabled);
        }
      }

      function setProModeEnabled(enabled, options) {
        var normalized = !!enabled;
        proModeEnabled = normalized;
        applyProVisibility(normalized);
        if (!options || !options.skipRecalc) {
          recalc();
        }
      }

      function formatPricePlaceholder(value) {
        if (!value || !isFinite(value)) {
          return 'z.\u00A0B. 20';
        }
        var isInteger = Math.abs(value - Math.round(value)) < 0.001;
        var normalized = isInteger ? Math.round(value).toString() : value.toFixed(2);
        return normalized.replace('.', ',');
      }

      function getPrintDomain() {
        if (typeof window === 'undefined' || !window.location) {
          return 'warenschmiede.com';
        }
        var host = window.location.hostname || '';
        if (!host) {
          return 'warenschmiede.com';
        }
        return host.replace(/^www\./, '') || 'warenschmiede.com';
      }

      function setMaterialDefaults() {
        if (!materialSelect) return;
        var selected = materialSelect.value;
        var defaults = materialData[selected] || {};
        var gramsPerMeter = defaults.gramsPerMeter;

        if (weightInput) {
          if (gramsPerMeter) {
            weightInput.dataset.gramsPerMeter = gramsPerMeter.toFixed(2);
          } else {
            delete weightInput.dataset.gramsPerMeter;
          }
        }

        if (lengthInput) {
          if (gramsPerMeter) {
            lengthInput.dataset.gramsPerMeter = gramsPerMeter.toFixed(2);
          } else {
            delete lengthInput.dataset.gramsPerMeter;
          }
        }

        if (materialDensityHint) {
          materialDensityHint.textContent = defaults.densityHint || 'Richtwert: nach Bedarf anpassen';
        }

        if (pricePerKgInput) {
          var placeholder = formatPricePlaceholder(defaults.price);
          pricePerKgInput.placeholder = placeholder;
          var currentRaw = pricePerKgInput.value != null ? pricePerKgInput.value.toString().trim() : '';
          if (!currentRaw) {
            if (typeof defaults.price === 'number' && isFinite(defaults.price)) {
              pricePerKgInput.value = defaults.price.toString();
            } else {
              pricePerKgInput.value = '';
            }
          }
        }

        updatePriceSuggestionState(defaults);

        recalc();
      }

      function parseHours(value) {
        if (!value) return 0;
        if (value instanceof Date) {
          return value.getHours() + value.getMinutes() / 60;
        }
        var parts = value.split(':');
        var hours = parseFloat(parts[0]) || 0;
        var minutes = parseFloat(parts[1]) || 0;
        return hours + minutes / 60;
      }

      function readNumber(input) {
        if (!input) return 0;
        var raw = (input.value || '').toString().replace(',', '.');
        var val = parseFloat(raw);
        if (!isFinite(val) || val < 0) {
          return 0;
        }
        return val;
      }

      function updateModeVisibility() {
        var useWeight = weightMode.checked;
        if (weightField) weightField.hidden = !useWeight;
        if (lengthField) lengthField.hidden = useWeight;
        recalc();
      }

      function formatMinutesDisplay(totalMinutes) {
        var rounded = Math.round(totalMinutes);
        if (!rounded) {
          return '0\u00A0min';
        }
        var hoursPart = Math.floor(rounded / 60);
        var minutesPart = Math.abs(rounded % 60);
        if (hoursPart > 0) {
          if (minutesPart === 0) {
            return hoursPart + '\u00A0h';
          }
          return hoursPart + '\u00A0h ' + minutesPart + '\u00A0min';
        }
        return minutesPart + '\u00A0min';
      }

      function updatePrintTimestamp() {
        if (printTimestampOutput) {
          printTimestampOutput.textContent = dateTimeFormatter.format(new Date());
        }
      }

      function setPrintAttribute(mode) {
        if (!rootElement) return;
        if (mode) {
          rootElement.setAttribute('data-print', mode);
        } else {
          rootElement.removeAttribute('data-print');
        }
      }

      function triggerPrint(mode) {
        setPrintAttribute(mode);
        updatePrintTimestamp();
        recalc();
        window.print();
      }

      function hasValue(value) {
        return Math.abs(value) > 0.005;
      }

      function syncProMinutesFromTime(hours) {
        if (!proPrintMinutesInput || suppressProSync) {
          return;
        }
        if (document.activeElement === proPrintMinutesInput) {
          return;
        }
        var minutes = Math.round(hours * 60);
        if (!minutes) {
          proPrintMinutesInput.value = '';
        } else {
          proPrintMinutesInput.value = minutes.toString();
        }
      }

      function updateTimeFromProMinutes() {
        if (!proPrintMinutesInput || !timeInput) {
          return;
        }
        suppressProSync = true;
        var minutes = Math.max(readNumber(proPrintMinutesInput), 0);
        var hoursPart = Math.floor(minutes / 60);
        var minutesPart = Math.round(minutes % 60);
        var hh = String(hoursPart).padStart(2, '0');
        var mm = String(minutesPart).padStart(2, '0');
        timeInput.value = hh + ':' + mm;
        suppressProSync = false;
        recalc();
      }

      function computeState() {
        var selected = materialSelect.value;
        var defaults = materialData[selected] || {};
        var gramsPerMeter = defaults.gramsPerMeter || 0;

        var pricePerKg = readNumber(pricePerKgInput);

        var weight = readNumber(weightInput);
        var length = readNumber(lengthInput);

        if (weightMode.checked) {
          if (gramsPerMeter > 0) {
            length = weight / gramsPerMeter;
            lengthInput.value = length ? length.toFixed(2) : '';
          } else {
            length = 0;
            lengthInput.value = '';
          }
        } else {
          if (gramsPerMeter > 0) {
            weight = length * gramsPerMeter;
            weightInput.value = weight ? weight.toFixed(0) : '';
          } else {
            weight = 0;
            weightInput.value = '';
          }
        }

        var hours = parseHours(timeInput.value || '0:00');
        var power = readNumber(powerInput);
        var energyPrice = readNumber(energyPriceInput);
        var loadFactorRaw = (loadFactorInput.value || '').trim();
        var loadFactorValue = readNumber(loadFactorInput);
        var loadFactor = Math.min(Math.max(loadFactorValue, 0), 100);
        if (!loadFactorRaw) {
          loadFactorInput.value = '';
        } else {
          var parsedLoadFactor = parseFloat(loadFactorRaw.replace(',', '.'));
          if (!isFinite(parsedLoadFactor)) {
            loadFactorInput.value = '';
          } else if (Math.abs(parsedLoadFactor - loadFactor) > 0.0001) {
            loadFactorInput.value = loadFactor.toString();
          }
        }

        syncProMinutesFromTime(hours);

        var materialCost = (weight / 1000) * pricePerKg;
        var wastePercentRaw = wastePercentInput ? (wastePercentInput.value || '').trim() : '';
        var wastePercent = wastePercentInput ? readNumber(wastePercentInput) : 0;
        if (wastePercentInput && wastePercent > 100) {
          wastePercent = 100;
          wastePercentInput.value = wastePercent.toString();
        } else if (!wastePercentRaw && wastePercentInput) {
          wastePercent = 0;
          wastePercentInput.value = '';
        }

        var materialWaste = materialCost * (wastePercent / 100);
        var materialWithWaste = materialCost + materialWaste;
        var energyCost = (power / 1000) * hours * energyPrice * (loadFactor / 100);
        var vatIncluded = !!vatCheckbox.checked;
        var labourMinutes = 0;
        var timeCost = 0;
        var fixedCostValue = 0;
        var standardSubtotal = materialWithWaste + energyCost;
        var marginBase = standardSubtotal;
        var marginValue = 0;
        var discountPercentValue = 0;
        var discountValue = 0;
        var netBeforeDiscount = marginBase;
        var net = marginBase;
        var gross = vatIncluded ? net * 1.19 : net;

        var proEnabled = proModeEnabled;
        var defaultMinutes = Math.round(hours * 60);
        var proData = {
          enabled: proEnabled,
          profitMargin: 0,
          hourlyRate: 0,
          setupMinutes: 0,
          printMinutes: defaultMinutes,
          finishingMinutes: 0,
          wastePercent: wastePercent,
          materialWaste: materialWaste,
          materialWithWaste: materialWithWaste,
          labourMinutes: labourMinutes,
          timeCost: timeCost,
          fixedCost: fixedCostValue,
          marginBase: marginBase,
          subtotal: marginBase,
          marginValue: marginValue,
          discountPercent: discountPercentValue,
          discountValue: discountValue,
          netBeforeDiscount: netBeforeDiscount,
          net: net,
          gross: gross,
          standardSubtotal: standardSubtotal
        };

        if (proEnabled) {
          var profitMargin = readNumber(profitMarginInput);
          if (profitMargin > 100) {
            profitMargin = 100;
            profitMarginInput.value = profitMargin.toString();
          }
          var hourlyRate = readNumber(hourlyRateInput);
          var setupMinutes = readNumber(setupMinutesInput);
          var proMinutes = readNumber(proPrintMinutesInput);
          if (!proMinutes && defaultMinutes) {
            proMinutes = defaultMinutes;
            proPrintMinutesInput.value = proMinutes.toString();
          }
          var finishingMinutes = readNumber(finishingMinutesInput);
          var fixedCost = readNumber(fixedCostInput);
          var discountPercent = readNumber(discountPercentInput);
          if (discountPercent > 100) {
            discountPercent = 100;
            discountPercentInput.value = discountPercent.toString();
          }

          standardSubtotal = materialWithWaste + energyCost;
          labourMinutes = setupMinutes + finishingMinutes;
          timeCost = (hourlyRate / 60) * labourMinutes;
          marginBase = standardSubtotal + timeCost;
          fixedCostValue = fixedCost;
          marginValue = marginBase * (profitMargin / 100);
          netBeforeDiscount = marginBase + marginValue + fixedCostValue;
          discountPercentValue = discountPercent;
          discountValue = netBeforeDiscount * (discountPercent / 100);
          var proNet = netBeforeDiscount - discountValue;
          var proGross = vatIncluded ? proNet * 1.19 : proNet;

          net = proNet;
          gross = proGross;

          proData = {
            enabled: true,
            profitMargin: profitMargin,
            hourlyRate: hourlyRate,
            setupMinutes: setupMinutes,
            printMinutes: proMinutes,
            finishingMinutes: finishingMinutes,
            wastePercent: wastePercent,
            materialWaste: materialWaste,
            materialWithWaste: materialWithWaste,
            labourMinutes: labourMinutes,
            timeCost: timeCost,
            fixedCost: fixedCostValue,
            marginBase: marginBase,
            subtotal: marginBase,
            marginValue: marginValue,
            discountPercent: discountPercentValue,
            discountValue: discountValue,
            netBeforeDiscount: netBeforeDiscount,
            net: proNet,
            gross: proGross,
            standardSubtotal: standardSubtotal
          };
        }

        var materialLabel = materialSelect.options[materialSelect.selectedIndex]
          ? materialSelect.options[materialSelect.selectedIndex].textContent
          : selected;

        return {
          materialLabel: materialLabel,
          pricePerKg: pricePerKg,
          modeLabel: weightMode.checked ? 'Bauteilgewicht' : 'Filamentlänge',
          weight: weight,
          length: length,
          hours: hours,
          power: power,
          energyPrice: energyPrice,
          loadFactor: loadFactor,
          vatIncluded: vatIncluded,
          materialCost: materialCost,
          energyCost: energyCost,
          net: net,
          gross: gross,
          standardSubtotal: standardSubtotal,
          pro: proData
        };
      }

      function updateResults(state) {
        materialCostOutput.textContent = formatter.format(state.materialCost);
        energyCostOutput.textContent = formatter.format(state.energyCost);
        totalNetOutput.textContent = formatter.format(state.net);
        totalGrossOutput.textContent = formatter.format(state.gross);

        if (grossLabelOutput) {
          grossLabelOutput.textContent = state.vatIncluded ? 'Gesamtkosten (brutto)' : 'Gesamtkosten (brutto, §19 UStG)';
        }

        var weightText = integerFormatter.format(state.weight) + '\u00A0g';
        var lengthText = decimalFormatter.format(state.length) + '\u00A0m';
        var metaText = 'Gewicht: ' + weightText + ' · Länge: ' + lengthText;
        if (state.pro.enabled) {
          metaText += ' · Erweiterter Rechner aktiv';
        }
        metaOutput.textContent = metaText;

        materialCostLabelOutput.textContent = 'Material (Basis)';
        if (energyCostLabelOutput) {
          energyCostLabelOutput.textContent = 'Energiekosten';
        }

        if (materialWasteOutput) {
          materialWasteOutput.textContent = formatter.format(state.pro.materialWaste);
        }
        if (materialWasteRow) {
          materialWasteRow.hidden = false;
        }

        if (materialTotalOutput) {
          materialTotalOutput.textContent = formatter.format(state.pro.materialWithWaste);
        }
        if (materialTotalRow) {
          materialTotalRow.hidden = false;
        }

        if (timeCostOutput) {
          timeCostOutput.textContent = formatter.format(state.pro.timeCost);
        }

        if (fixedCostOutput) {
          fixedCostOutput.textContent = formatter.format(state.pro.fixedCost);
        }

        if (subtotalOutput) {
          var subtotalValue = state.pro.enabled ? state.pro.subtotal : state.standardSubtotal;
          subtotalOutput.textContent = formatter.format(subtotalValue);
        }

        if (marginOutput) {
          marginOutput.textContent = formatter.format(state.pro.marginValue);
        }

        if (discountOutput) {
          var discountText = hasValue(state.pro.discountValue)
            ? '– ' + formatter.format(state.pro.discountValue)
            : formatter.format(state.pro.discountValue);
          discountOutput.textContent = discountText;
        }
      }

      function updatePrintSummary(state) {
        if (!printMaterialOutput) {
          return;
        }

        printMaterialOutput.textContent = state.materialLabel;
        printMaterialPriceOutput.textContent = decimalFormatter.format(state.pricePerKg) + '\u00A0€/kg';
        printModeOutput.textContent = state.modeLabel;
        printWeightOutput.textContent = integerFormatter.format(state.weight) + '\u00A0g';
        printLengthOutput.textContent = decimalFormatter.format(state.length) + '\u00A0m';
        printTimeOutput.textContent = formatMinutesDisplay(state.hours * 60);
        printPowerOutput.textContent = integerFormatter.format(state.power) + '\u00A0W';
        printEnergyPriceOutput.textContent = decimalFormatter.format(state.energyPrice) + '\u00A0€/kWh';
        printLoadFactorOutput.textContent = integerFormatter.format(state.loadFactor) + '\u00A0%';

        if (printMaterialLabelOutput) {
          printMaterialLabelOutput.textContent = 'Material (Basis)';
        }
        printMaterialCostOutput.textContent = formatter.format(state.materialCost);

        if (printWasteCostOutput) {
          printWasteCostOutput.textContent = formatter.format(state.pro.materialWaste);
        }

        if (printMaterialTotalOutput) {
          printMaterialTotalOutput.textContent = formatter.format(state.pro.materialWithWaste);
        }

        if (printEnergyLabelOutput) {
          printEnergyLabelOutput.textContent = 'Energiekosten';
        }
        printEnergyCostOutput.textContent = formatter.format(state.energyCost);

        if (printTimeCostOutput) {
          printTimeCostOutput.textContent = formatter.format(state.pro.timeCost);
        }

        if (printFixedCostOutput) {
          printFixedCostOutput.textContent = formatter.format(state.pro.fixedCost);
        }

        if (printSubtotalOutput) {
          var printSubtotalValue = state.pro.enabled ? state.pro.subtotal : state.standardSubtotal;
          printSubtotalOutput.textContent = formatter.format(printSubtotalValue);
        }

        if (printMarginOutput) {
          printMarginOutput.textContent = formatter.format(state.pro.marginValue);
        }

        if (printDiscountOutput) {
          var printDiscountText = hasValue(state.pro.discountValue)
            ? '– ' + formatter.format(state.pro.discountValue)
            : formatter.format(state.pro.discountValue);
          printDiscountOutput.textContent = printDiscountText;
        }

        printNetOutput.textContent = formatter.format(state.net);
        printGrossOutput.textContent = formatter.format(state.gross);

        var highlightValue = state.vatIncluded ? state.gross : state.net;
        printTotalOutput.textContent = formatter.format(highlightValue);

        if (state.vatIncluded) {
          printVatNoteOutput.textContent = 'Preise inkl. MwSt. (19\u00A0%)';
        } else {
          printVatNoteOutput.textContent = 'Hinweis: §19 UStG – keine Umsatzsteuer.';
        }

        if (printProParamsSection && state.pro.enabled) {
          printProfitMarginOutput.textContent = percentNumberFormatter.format(state.pro.profitMargin) + '\u00A0%';
          printHourlyRateOutput.textContent = formatter.format(state.pro.hourlyRate) + '/h';
          printSetupMinutesOutput.textContent = integerFormatter.format(state.pro.setupMinutes) + '\u00A0min';
          printProPrintMinutesOutput.textContent = integerFormatter.format(state.pro.printMinutes) + '\u00A0min';
          printFinishingMinutesOutput.textContent = integerFormatter.format(state.pro.finishingMinutes) + '\u00A0min';
          printWastePercentOutput.textContent = percentNumberFormatter.format(state.pro.wastePercent) + '\u00A0%';
          printFixedCostInputOutput.textContent = formatter.format(state.pro.fixedCost);
          printDiscountPercentOutput.textContent = percentNumberFormatter.format(state.pro.discountPercent) + '\u00A0%';
        }

        if (printUrlOutput) {
          printUrlOutput.textContent = getPrintDomain();
        }
      }

      function recalc() {
        var state = computeState();
        updateResults(state);
        updatePrintSummary(state);
      }

      materialSelect.addEventListener('change', setMaterialDefaults);
      weightMode.addEventListener('change', updateModeVisibility);
      lengthMode.addEventListener('change', updateModeVisibility);

      [pricePerKgInput, weightInput, lengthInput, timeInput, powerInput, energyPriceInput, loadFactorInput, wastePercentInput].forEach(function (input) {
        if (!input) return;
        input.addEventListener('input', function () {
          if (input === pricePerKgInput) {
            var currentDefaults = materialSelect ? materialData[materialSelect.value] || {} : {};
            updatePriceSuggestionState(currentDefaults);
          }
          recalc();
        });
      });

      if (priceSuggestionButton) {
        priceSuggestionButton.addEventListener('click', function () {
          if (!materialSelect || !pricePerKgInput) {
            return;
          }

          var defaults = materialData[materialSelect.value] || {};
          if (typeof defaults.price !== 'number' || !isFinite(defaults.price)) {
            return;
          }

          pricePerKgInput.value = defaults.price.toString();
          updatePriceSuggestionState(defaults);
          recalc();

          pricePerKgInput.focus();
        });
      }

      vatCheckbox.addEventListener('change', recalc);

      if (printResultButton) {
        printResultButton.addEventListener('click', function () {
          triggerPrint('result');
        });
      }

      if (printFullButton) {
        printFullButton.addEventListener('click', function () {
          triggerPrint('full');
        });
      }

      setProModeEnabled(false, { skipRecalc: true });

      if (proToggle) {
        proToggle.addEventListener('change', function () {
          setProModeEnabled(proToggle.checked);
        });
      }

      [profitMarginInput, hourlyRateInput, setupMinutesInput, finishingMinutesInput, fixedCostInput, discountPercentInput].forEach(function (input) {
        if (!input) return;
        input.addEventListener('input', recalc);
      });

      if (proPrintMinutesInput) {
        proPrintMinutesInput.addEventListener('input', updateTimeFromProMinutes);
      }

      if (printUrlOutput) {
        printUrlOutput.textContent = getPrintDomain();
      }

      updatePrintTimestamp();
      window.addEventListener('beforeprint', function () {
        updatePrintTimestamp();
        recalc();
      });

      window.addEventListener('afterprint', function () {
        setPrintAttribute(null);
      });

      setMaterialDefaults();
      updateModeVisibility();
    })();
  </script>
</body>
</html>
