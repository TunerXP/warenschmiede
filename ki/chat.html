<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="icon" type="image/png" href="/ws.png" sizes="32x32">
  <link rel="apple-touch-icon" href="/ws.png" sizes="180x180">
  <meta name="theme-color" content="#ffffff">
  <title>KI-Versteher: Adaptiver Chat-Simulator - Warenschmiede</title>
  <meta name="description" content="Simulierter KI-Chat, der sich an dich anpasst. Erkl√§rungen f√ºr Einsteiger, Berufst√§tige, Sch√ºler und Skeptiker.">
  <link rel="preload" as="image" href="/assets/logo.svg">
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="/assets/print.css?v=1.0.7" media="print">

  <style>
    /* Chat Specific Styles */
    .chat-container {
        max-width: 600px;
        width: 100%;
        margin: 0 auto;
        background: #efeae2;
        border-radius: 20px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        overflow: hidden;
        border: 1px solid #ddd;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        display: flex;
        flex-direction: column;
        height: 75vh;
        max-height: 800px;
        min-height: 500px;
        position: relative;
    }

    /* WhatsApp Background Pattern simulation */
    .chat-body {
        flex: 1;
        overflow-y: auto;
        padding: 20px 15px;
        display: flex;
        flex-direction: column;
        gap: 8px;
        background-color: #efeae2;
        background-image: radial-gradient(#d4d0c8 1px, transparent 1px);
        background-size: 20px 20px;
    }

    .chat-header {
        background: #008069;
        color: white;
        padding: 10px 15px;
        display: flex;
        align-items: center;
        gap: 12px;
        position: sticky;
        top: 0;
        z-index: 10;
        box-shadow: 0 1px 2px rgba(0,0,0,0.15);
    }

    .chat-header-avatar {
        width: 42px;
        height: 42px;
        border-radius: 50%;
        background: #fff;
        overflow: hidden;
        flex-shrink: 0;
    }
    .chat-header-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .chat-header-info {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .chat-header-name {
        font-weight: 600;
        font-size: 1.05rem;
        line-height: 1.2;
    }

    .chat-header-status {
        font-size: 0.8rem;
        opacity: 0.85;
        line-height: 1.2;
    }

    .message {
        max-width: 85%;
        padding: 6px 7px 8px 9px;
        border-radius: 7.5px;
        position: relative;
        font-size: 0.95rem;
        line-height: 1.35;
        box-shadow: 0 1px 0.5px rgba(0,0,0,0.13);
        opacity: 0;
        transform: translateY(10px);
        animation: messageAppear 0.3s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        word-wrap: break-word;
    }

    @keyframes messageAppear {
        to { opacity: 1; transform: translateY(0); }
    }

    .message.marco {
        align-self: flex-start;
        background: #ffffff;
        border-top-left-radius: 0;
    }

    .message.gast {
        align-self: flex-end;
        background: #d9fdd3;
        border-top-right-radius: 0;
    }

    .message-content {
        padding-right: 20px; /* Space for time */
    }

    .message-time {
        font-size: 0.68rem;
        color: rgba(0,0,0,0.45);
        float: right;
        margin-top: 4px;
        margin-left: -10px;
        position: relative;
        top: 2px;
    }

    .message a {
        color: #007bfc;
        text-decoration: none;
    }
    .message a:hover {
        text-decoration: underline;
    }

    .typing-container {
        padding: 0 15px 10px;
        min-height: 40px;
    }

    .typing-indicator {
        background: #ffffff;
        padding: 10px 15px;
        border-radius: 18px;
        border-top-left-radius: 0;
        display: inline-flex;
        align-items: center;
        gap: 4px;
        box-shadow: 0 1px 0.5px rgba(0,0,0,0.13);
        opacity: 0;
        transition: opacity 0.2s;
    }

    .typing-indicator.visible {
        opacity: 1;
    }

    .dot {
        width: 6px;
        height: 6px;
        background: #b0b0b0;
        border-radius: 50%;
        animation: typingBounce 1.4s infinite ease-in-out both;
    }
    .dot:nth-child(1) { animation-delay: -0.32s; }
    .dot:nth-child(2) { animation-delay: -0.16s; }

    @keyframes typingBounce {
        0%, 80%, 100% { transform: scale(0); }
        40% { transform: scale(1); }
    }

    .chat-controls {
        background: #f0f2f5;
        padding: 10px;
        display: flex;
        justify-content: center;
        gap: 10px;
        border-top: 1px solid #ddd;
        flex-wrap: wrap;
    }

    .chat-btn {
        background: #fff;
        border: 1px solid #ccc;
        border-radius: 24px;
        padding: 8px 16px;
        cursor: pointer;
        font-size: 0.9rem;
        display: flex;
        align-items: center;
        gap: 6px;
        transition: all 0.2s;
        color: var(--text);
    }
    .chat-btn:hover {
        background: #e9edef;
    }
    .chat-btn:active {
        background: #dce1e5;
    }

    /* Option Chips */
    .options-container {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 5px;
        margin-bottom: 10px;
        animation: messageAppear 0.3s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
    }
    .option-chip {
        background: #fff;
        border: 1px solid #008069;
        color: #008069;
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 0.9rem;
        cursor: pointer;
        transition: all 0.2s;
        font-weight: 500;
        box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }
    .option-chip:hover {
        background: #f0fffa;
        transform: translateY(-1px);
        box-shadow: 0 2px 4px rgba(0,0,0,0.15);
    }

    /* Persona Overlay */
    .persona-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.98);
        z-index: 100;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
        text-align: center;
    }

    .persona-overlay h2 {
        margin-bottom: 1.5rem;
        font-size: 1.5rem;
        color: var(--text);
    }

    .persona-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        width: 100%;
        max-width: 500px;
    }

    .persona-card {
        background: white;
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 20px 10px;
        cursor: pointer;
        transition: all 0.2s;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
    }

    .persona-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        border-color: #008069;
    }

    .persona-emoji {
        font-size: 2.5rem;
        margin-bottom: 5px;
    }
    .persona-title {
        font-weight: 700;
        font-size: 1rem;
        color: var(--text);
    }
    .persona-desc {
        font-size: 0.8rem;
        color: var(--text-muted);
    }

    /* Online Status Animation */
    @keyframes pulse {
        0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
        70% { transform: scale(1); box-shadow: 0 0 0 6px rgba(34, 197, 94, 0); }
        100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
    }

    .status-dot {
        display: inline-block;
        width: 10px;
        height: 10px;
        background-color: #22c55e;
        border-radius: 50%;
        margin-left: 8px;
        animation: pulse 2s infinite;
    }

    /* Ensure the chat looks good in dark mode context */
    html[data-theme="dark"] .chat-container,
    html.dark .chat-container {
        border-color: #334155;
        background: #1e293b;
    }
    html[data-theme="dark"] .chat-header,
    html.dark .chat-header {
        background: #0f172a;
    }
    html[data-theme="dark"] .chat-body,
    html.dark .chat-body {
        background-color: #0f172a;
        background-image: radial-gradient(#334155 1px, transparent 1px);
    }
    html[data-theme="dark"] .message.gast,
    html.dark .message.gast {
        background: #334155;
        color: #f8fafc;
    }
    html[data-theme="dark"] .message.marco,
    html.dark .message.marco {
        background: #1e3a8a;
        color: #ffffff;
    }
    html[data-theme="dark"] .chat-controls,
    html.dark .chat-controls {
        background: #1e293b;
        border-top-color: #334155;
    }
    html[data-theme="dark"] .chat-header-name,
    html[data-theme="dark"] .chat-header-status,
    html.dark .chat-header-name,
    html.dark .chat-header-status {
        color: #f8fafc;
    }
    html[data-theme="dark"] .message-time,
    html.dark .message-time {
        color: rgba(255,255,255,0.6);
    }

    html[data-theme="dark"] .chat-btn,
    html.dark .chat-btn {
        background: #2a3942;
        border-color: #444;
        color: #e9edef;
    }
    html[data-theme="dark"] .chat-btn:hover,
    html.dark .chat-btn:hover {
        background: #3c4a53;
    }
    html[data-theme="dark"] .persona-overlay,
    html.dark .persona-overlay {
        background: rgba(15, 23, 42, 0.98);
    }
    html[data-theme="dark"] .persona-card,
    html.dark .persona-card {
        background: #1e293b;
        border-color: #334155;
    }
    html[data-theme="dark"] .persona-card:hover,
    html.dark .persona-card:hover {
        border-color: #008069;
        background: #2a3942;
    }
    html[data-theme="dark"] .option-chip,
    html.dark .option-chip {
        background: #1e293b;
        border-color: #008069;
        color: #22c55e;
    }
    html[data-theme="dark"] .option-chip:hover,
    html.dark .option-chip:hover {
        background: #008069;
        color: white;
    }

    @media (max-width: 500px) {
        .persona-grid {
            grid-template-columns: 1fr;
        }
    }
  </style>
  <script src="../assets/js/theme.js"></script>
</head>
<body>
  <header class="site-header" data-header>
    <div class="ws-nav-container header-grid">
      <div class="brand">
        <a class="brand-link" href="/index.html#start">
          <img src="/assets/images/warenschmiede_logo.png" alt="Warenschmiede Logo" class="brand-logo" width="453" height="276" fetchpriority="high">
          <div class="brand-text">
            <span class="brand-name">Warenschmiede</span>
            <span class="brand-tagline">3D-Druck ¬∑ Made in Germany</span>
          </div>
        </a>
      </div>

      <nav class="main-nav" aria-label="Hauptnavigation">
        <div class="nav-menu" id="primary-navigation" data-nav-menu>
          <ul class="nav-list" id="navList">
            <li class="nav-item nav-fixed">
              <a class="nav-link" href="/index.html#start" data-nav-link data-section="start" data-path="/ , /index.html , /warenschmiede/ , /warenschmiede/index.html"><span class="nav-ico" aria-hidden="true">üè†</span>Start</a>
            </li>

            <li class="nav-item nav-fixed">
              <a class="nav-link" href="/downloads.html" data-nav-link data-path="/downloads , /downloads.html"><span class="nav-ico" aria-hidden="true">üì•</span>Downloads</a>
            </li>

            <li class="nav-item nav-fixed nav-more nav-dropdown nav-highlight nav-tools" data-nav-dropdown>
              <button class="nav-more-btn" type="button" aria-haspopup="true" aria-expanded="false">
                <span class="nav-ico" aria-hidden="true">üßÆ</span>Online Tools ‚ñæ
              </button>
              <ul class="nav-more-menu" hidden>
                <li>
                  <a class="nav-link" href="/tools/" data-nav-link data-path="/tools , /tools/ , /tools/index.html">
                    <span class="nav-ico" aria-hidden="true">üóÇÔ∏è</span>Tool-√úbersicht (Dashboard)
                  </a>
                </li>
                <li>
                  <a class="nav-link" href="/werkstatt-rechner.html" data-nav-link data-path="/werkstatt-rechner , /werkstatt-rechner.html">
                    <span class="nav-ico" aria-hidden="true">üõ†Ô∏è</span>Warenschmiede METALL
                  </a>
                </li>
                <li>
                  <a class="nav-link" href="/tools/kostenrechner-v2.html" data-nav-link data-path="/tools/kostenrechner-v2 , /tools/kostenrechner-v2.html">
                    <span class="nav-ico" aria-hidden="true">üßÆ</span>Warenschmiede 3D-Druck Suite
                  </a>
                </li>
                <li>
                  <a class="nav-link" href="/tools/buero/doku-light/QRCodeMasterPro.html" data-nav-link data-path="/tools/buero/doku-light/QRCodeMasterPro , /tools/buero/doku-light/QRCodeMasterPro.html">
                    <span class="nav-ico" aria-hidden="true">üî≥</span>Warenschmiede QR-Master ULTRA
                  </a>
                </li>
              </ul>
            </li>

            <li class="nav-item nav-fixed nav-more nav-dropdown nav-services" data-nav-dropdown>
              <button class="nav-more-btn" type="button" aria-haspopup="true" aria-expanded="false"><span class="nav-ico" aria-hidden="true">üß∞</span>Leistungen ‚ñæ</button>
              <ul class="nav-more-menu" hidden>
                <li>
                  <a class="nav-link" href="/leistungen/3d-druck.html" data-nav-link data-path="/leistungen/3d-druck , /leistungen/3d-druck.html"><span class="nav-ico" aria-hidden="true">üì¶</span>3D-Druckauftrag</a>
                </li>
                <li>
                  <a class="nav-link" href="/leistungen/cad-prototyping.html" data-nav-link data-path="/leistungen/cad-prototyping , /leistungen/cad-prototyping.html"><span class="nav-ico" aria-hidden="true">üìê</span>CAD &amp; Prototyping</a>
                </li>
                <li>
                  <a class="nav-link" href="/leistungen/pc-hilfe.html" data-nav-link data-path="/leistungen/pc-hilfe , /leistungen/pc-hilfe.html"><span class="nav-ico" aria-hidden="true">üíª</span>PC-Hilfe</a>
                </li>
              </ul>
            </li>
            <li class="nav-item nav-fixed nav-more nav-dropdown" data-nav-dropdown>
              <button class="nav-more-btn" type="button" aria-haspopup="true" aria-expanded="false"><span class="nav-ico" aria-hidden="true">ü§ñ</span>√úber KI ‚ñæ</button>
              <ul class="nav-more-menu" hidden>
                <li><a class="nav-link" href="/ki/chat.html"><span class="nav-ico" aria-hidden="true">üí¨</span>Interaktiver KI Versteher (NEU)</a></li>
                <li>
                  <a class="nav-link" href="/ki/index.html" data-nav-link data-path="/ki , /ki/ , /ki/index.html"><span class="nav-ico" aria-hidden="true">üìñ</span>Einf√ºhrung &amp; Grundlagen</a>
                </li>
                <li>
                  <a class="nav-link" href="/ki/prompts.html" data-nav-link data-path="/ki/prompts , /ki/prompts.html"><span class="nav-ico" aria-hidden="true">‚úçÔ∏è</span>Prompts f√ºr den Alltag</a>
                </li>
                <li>
                  <a class="nav-link" href="/ki/promt-trainer.html" data-nav-link data-path="/ki/promt-trainer , /ki/promt-trainer.html"><span class="nav-ico" aria-hidden="true">üß†</span>KI Trainer</a>
                </li>
                <li>
                  <a class="nav-link" href="/ki/ki-finder.html" data-nav-link data-path="/ki/ki-finder , /ki/ki-finder.html"><span class="nav-ico" aria-hidden="true">üß≠</span>Warenschmiede KI-Finder</a>
                </li>
                <li>
                  <a class="nav-link" href="/ki/tools.html" data-nav-link data-path="/ki/tools , /ki/tools.html"><span class="nav-ico" aria-hidden="true">üõ†Ô∏è</span>KI-Werkzeuge</a>
                </li>
                <li>
                  <a class="nav-link" href="/ki/so-arbeitest-du-mit-ki.html" data-nav-link data-path="/ki/so-arbeitest-du-mit-ki , /ki/so-arbeitest-du-mit-ki.html"><span class="nav-ico" aria-hidden="true">üß≠</span>So arbeitest du mit KI</a>
                </li>
                <li>
                  <a class="nav-link" href="/ki/programme-die-du-brauchst.html" data-nav-link data-path="/ki/programme-die-du-brauchst , /ki/programme-die-du-brauchst.html"><span class="nav-ico" aria-hidden="true">üíæ</span>Programme, die du brauchst</a>
                </li>
                <li>
                  <a class="nav-link" href="/ki/chancen-und-risiken.html" data-nav-link data-path="/ki/chancen-und-risiken , /ki/chancen-und-risiken.html"><span class="nav-ico" aria-hidden="true">‚öñÔ∏è</span>KI: Chancen &amp; Risiken</a>
                </li>
                <li>
                  <a class="nav-link" href="/ki/faq.html" data-nav-link data-path="/ki/faq , /ki/faq.html"><span class="nav-ico" aria-hidden="true">üîí</span>KI-FAQ &amp; Sicherheit</a>
                </li>
                <li>
                  <a class="nav-link" href="/ki/lexikon.html" data-nav-link data-path="/ki/lexikon , /ki/lexikon.html"><span class="nav-ico" aria-hidden="true">üî§</span>KI-Lexikon</a>
                </li>
              </ul>
            </li>
            <li class="nav-item nav-fixed nav-more nav-dropdown nav-contact" data-nav-dropdown>
              <button class="nav-more-btn" type="button" aria-haspopup="true" aria-expanded="false"><span class="nav-ico" aria-hidden="true">‚úâÔ∏è</span>Kontakt ‚ñæ</button>
              <ul class="nav-more-menu" hidden>
                <li>
                  <a class="nav-link" href="/kontakt.html" data-nav-link data-path="/kontakt , /kontakt.html , /warenschmiede/kontakt , /warenschmiede/kontakt.html"><span class="nav-ico" aria-hidden="true">üìß</span>Kontakt aufnehmen</a>
                </li>
                <li>
                  <a class="nav-link" href="/ablauf-anfrage.html" data-nav-link data-path="/ablauf-anfrage , /ablauf-anfrage.html"><span class="nav-ico" aria-hidden="true">üìù</span>Ablauf &amp; Anfrage</a>
                </li>
                <li>
                  <a class="nav-link" href="/impressum.html" data-nav-link data-path="/impressum , /impressum.html , /warenschmiede/impressum , /warenschmiede/impressum.html"><span class="nav-ico" aria-hidden="true">‚öñÔ∏è</span>Impressum</a>
                </li>
                <li>
                  <a class="nav-link" href="/ueber-mich.html" data-nav-link data-path="/ueber-mich , /ueber-mich.html , /warenschmiede/ueber-mich.html , /about , /about.html , /warenschmiede/about.html"><span class="nav-ico" aria-hidden="true">üë§</span>√úber mich</a>
                </li>
              </ul>
            </li>

            <li class="nav-item nav-fixed nav-more nav-dropdown nav-3d" data-nav-dropdown>
              <button class="nav-more-btn" type="button" aria-haspopup="true" aria-expanded="false"><span class="nav-ico" aria-hidden="true">üì¶</span>3D-Druck ‚ñæ</button>
              <ul class="nav-more-menu" hidden>
                <li>
                  <a class="nav-link" href="/3ddruck-chat.html" data-nav-link data-path="/3ddruck-chat , /3ddruck-chat.html"><span class="nav-ico" aria-hidden="true">üí¨</span>Interaktiver Berater (Neu)</a>
                </li>
                <li>
                  <a class="nav-link" href="/technologien.html" data-nav-link data-path="/technologien , /technologien.html"><span class="nav-ico" aria-hidden="true">üß™</span>FDM / SLA / SLS ‚Äì Technologien</a>
                </li>
                <li>
                  <a class="nav-link" href="/fehlerdatenbank.html" data-nav-link data-path="/fehlerdatenbank , /fehlerdatenbank.html"><span class="nav-ico" aria-hidden="true">üõ†Ô∏è</span>Fehler &amp; Troubleshooting</a>
                </li>
                <li>
                  <a class="nav-link" href="/ideenquellen.html" data-nav-link data-path="/ideenquellen , /ideenquellen.html , /ideen , /ideen/ , /ideen/index.html"><span class="nav-ico" aria-hidden="true">üí°</span>Ideenquellen &amp; Portale</a>
                </li>
                <li>
                  <a class="nav-link" href="/material.html" data-nav-link data-path="/material.html"><span class="nav-ico" aria-hidden="true">üìö</span>Materialwissen &amp; Vergleiche</a>
                </li>
                <li>
                  <a class="nav-link" href="/druck-tipps.html" data-nav-link data-path="/druck-tipps , /druck-tipps.html"><span class="nav-ico" aria-hidden="true">üß≠</span>Tipps &amp; Abl√§ufe / Kosten</a>
                </li>
                <li>
                  <a class="nav-link" href="/tools/kostenrechner-v2.html" data-nav-link data-path="/tools/kostenrechner-v2 , /tools/kostenrechner-v2.html"><span class="nav-ico" aria-hidden="true">üßÆ</span>Kosten &amp; Kalkulation</a>
                </li>
                <li>
                  <a class="nav-link" href="/slicer-einstellungen.html" data-nav-link data-path="/slicer-einstellungen , /slicer-einstellungen.html"><span class="nav-ico" aria-hidden="true">‚öôÔ∏è</span>Slicer &amp; Einstellungen</a>
                </li>
                <li>
                  <a class="nav-link" href="/3ddruck-faq.html" data-nav-link data-path="/3ddruck-faq , /3ddruck-faq.html"><span class="nav-ico" aria-hidden="true">‚ùì</span>Neu beim 3D-Druck?</a>
                </li>
                <li>
                  <a class="nav-link" href="/wartung-reinigung.html" data-nav-link data-path="/wartung-reinigung , /wartung-reinigung.html"><span class="nav-ico" aria-hidden="true">üßº</span>Wartung &amp; Reinigung</a>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>

      <div class="header-actions">
        <button class="theme-toggle" type="button" id="themeToggleBtn" aria-label="Design umschalten: Hell/Dunkel" title="Design umschalten: Hell/Dunkel" aria-pressed="false">
          <span id="themeIcon" aria-hidden="true">üñ•Ô∏è</span>
          <span class="theme-toggle__text" id="themeToggleText" aria-live="polite">Helles Design</span>
        </button>

        <button class="nav-toggle" type="button" aria-controls="primary-navigation" aria-expanded="false" data-nav-toggle>
          <span class="sr-only">Men√º √∂ffnen</span>
          <span class="nav-toggle-bar" aria-hidden="true"></span>
          <span class="nav-toggle-bar" aria-hidden="true"></span>
          <span class="nav-toggle-bar" aria-hidden="true"></span>
        </button>
      </div>
    </div>
  </header>

  <main class="site-main">
    <div class="container">
        <div class="ws-section" style="text-align: center;">
            <h1 class="ws-page-title">KI-Versteher</h1>
            <p style="color: var(--text-muted); max-width: 600px; margin: 0 auto;">
                W√§hle deinen Modus und entdecke, was K√ºnstliche Intelligenz f√ºr dich bedeutet.
            </p>
        </div>

        <div class="chat-container">
            <div class="persona-overlay" id="persona-overlay">
                <h2>KI einfach erkl√§rt.<br>Wer fragt gerade?</h2>
                <div class="persona-grid">
                    <div class="persona-card" onclick="selectPersona('senior')">
                        <div class="persona-emoji">üë¥</div>
                        <div class="persona-title">Senior / Einsteiger</div>
                        <div class="persona-desc">Einfach & Sicher</div>
                    </div>
                    <div class="persona-card" onclick="selectPersona('adult')">
                        <div class="persona-emoji">üë®‚Äçüíº</div>
                        <div class="persona-title">Beruf & Alltag</div>
                        <div class="persona-desc">Effizient & Praxis</div>
                    </div>
                    <div class="persona-card" onclick="selectPersona('youth')">
                        <div class="persona-emoji">üéÆ</div>
                        <div class="persona-title">Jugend & Schule</div>
                        <div class="persona-desc">Locker & Future</div>
                    </div>
                    <div class="persona-card" onclick="selectPersona('skeptic')">
                        <div class="persona-emoji">ü§®</div>
                        <div class="persona-title">Skeptiker</div>
                        <div class="persona-desc">Kritisch & Fakten</div>
                    </div>
                </div>
            </div>

            <div class="chat-header">
                <div class="chat-header-avatar">
                     <img src="/assets/img/marco.jpg" alt="Marco" onerror="this.src='../assets/img/avatar-placeholder.svg'">
                </div>
                <div class="chat-header-info">
                    <div class="chat-header-name">Marco (KI-Guide) <span class="status-dot"></span></div>
                    <div class="chat-header-status" id="chat-status">Online</div>
                </div>
            </div>

            <div class="chat-body" id="chat-body">
                <!-- Messages go here -->
            </div>

            <div class="typing-container">
                <div class="typing-indicator" id="typing-indicator">
                    <div class="dot"></div>
                    <div class="dot"></div>
                    <div class="dot"></div>
                </div>
            </div>

            <div class="chat-controls">
                <button class="chat-btn" onclick="restartChat()">üîÑ Neustart / Wechseln</button>
            </div>
        </div>

        <div style="text-align: center; margin-top: 2rem; margin-bottom: 4rem;">
            <p style="color: var(--text-muted); font-size: 0.9rem;">
                Hinweis: Dies ist ein simulierter Chat. Alle Links √∂ffnen in einem neuen Tab.
            </p>
            <a href="/ki/tools.html" class="btn btn-primary">Alle KI-Tools ansehen</a>
        </div>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <div class="footer__inner">
        <div class="footer__brand">¬© 2026 Warenschmiede ¬∑ Alle Rechte vorbehalten.</div>
        <nav class="footer__links" aria-label="Rechtliches &amp; Kontakt">
          <a href="/impressum.html">Impressum</a>
          <a href="/datenschutz.html">Datenschutzerkl√§rung</a>
          <a href="/kontakt.html">Kontakt</a>
        </nav>
        <div class="footer__notes">
          <p><strong>Haftung / Nutzung:</strong> Alle Angaben ohne Gew√§hr ‚Äì Nutzung auf eigene Verantwortung.</p>
          <p><strong>Cookies:</strong> Diese Website verwendet keine Cookies oder Tracking.</p>
        </div>
      </div>
    </div>
  </footer>

  <script src="../assets/js/theme.js"></script>
  <script src="../assets/js/header.js"></script>

  <script>
    // Data Structure
        const PERSONAS = {
        senior: {
            name: "Senior",
            greeting: [
                { sender: 'marco', text: 'Hallo! üëã Sch√∂n, dass Sie sich trauen. Keine Sorge, wir gehen das ganz entspannt an.' },
                { sender: 'marco', text: 'Stellen Sie sich KI wie einen sehr belesenen **Bibliothekar** vor. üìö' },
                { sender: 'marco', text: 'Er hat alle B√ºcher der Welt gelesen, aber er "versteht" den Inhalt nicht wie ein Mensch mit Gef√ºhlen. Er r√§t statistisch, welches Wort als n√§chstes kommt. Er ist sehr hilfreich, aber man muss ihm genau sagen, was man will.' },
                { sender: 'marco', text: 'Was liegt Ihnen auf dem Herzen?' },
                { type: 'options', options: [
                    { label: 'Reisen & Sprachen', value: 'travel' },
                    { label: 'Gesundheit (Vorsicht)', value: 'health' },
                    { label: 'Wie bediene ich das?', value: 'basics' },
                    { label: 'Ist das sicher (Enkeltrick)?', value: 'risks' }
                ]}
            ],
            topics: {
                travel: {
                    messages: [
                        { sender: 'marco', text: 'Planen Sie einen Urlaub?' },
                        { type: 'options', options: [
                            { label: 'Ja, Ausland.', value: 'travel_yes' },
                            { label: 'Nein, nur Interesse.', value: 'restart_topics' }
                        ]}
                    ]
                },
                travel_yes: {
                    messages: [
                        { sender: 'marco', text: 'Toll! Installieren Sie Google Translate oder ChatGPT. Sie k√∂nnen ins Handy sprechen, und das Handy spricht die fremde Sprache laut aus.' },
                        { sender: 'marco', text: 'Wollen Sie ein Beispiel h√∂ren?' },
                        { type: 'options', options: [
                            { label: 'Ja, gerne', value: 'travel_ex_yes' },
                            { label: 'Nein', value: 'restart_topics' }
                        ]}
                    ]
                },
                travel_ex_yes: {
                    messages: [
                        { sender: 'marco', text: 'Marco simuliert: "Hola, ¬ød√≥nde est√° la farmacia? (Wo ist die Apotheke?)"' },
                        { sender: 'marco', text: 'Das funktioniert in fast allen Sprachen!' },
                        { type: 'options', options: [
                            { label: 'Anderes Thema', value: 'restart_topics' },
                            { label: 'Beenden', value: 'end' }
                        ]}
                    ]
                },
                health: {
                    messages: [
                        { sender: 'marco', text: 'Vorsicht bei Gesundheitsthemen!' },
                        { sender: 'marco', text: 'Dr. Google ist schon schlimm, aber **Dr. KI kann gef√§hrlich sein**.' },
                        { sender: 'marco', text: 'KIs k√∂nnen falsche Diagnosen stellen oder Medikamente verwechseln. Nutzen Sie es NIEMALS als Ersatz f√ºr einen Arztbesuch.' },
                        { sender: 'marco', text: 'Aber: Sie k√∂nnen den Arztbrief fotografieren und sagen: "Erkl√§re mir diese Fachbegriffe einfach". Das ist sehr hilfreich.' },
                        { type: 'options', options: [
                            { label: 'Verstanden, zur√ºck', value: 'restart_topics' },
                            { label: 'Danke, das war\'s', value: 'end' }
                        ]}
                    ]
                },
                basics: {
                    messages: [
                        { sender: 'gast', text: 'Ich bin kein Computer-Experte. Muss ich programmieren lernen?' },
                        { sender: 'marco', text: '√úberhaupt nicht! Das ist das Revolution√§re daran.' },
                        { sender: 'marco', text: 'Sie steuern diese Programme mit ganz normaler Sprache. Schreiben Sie einfach wie in einem Brief oder einer WhatsApp an die Familie.' },
                        { sender: 'marco', text: 'Beispiel: "Schreibe ein Gedicht f√ºr den 80. Geburtstag meiner Schwester Helga, sie mag Gartenarbeit." ‚Äì Und zack, schreibt der Computer das Gedicht.' },
                        { sender: 'marco', text: 'M√∂chten Sie wissen, wie man gute "Befehle" (Prompts) schreibt?' },
                        { type: 'options', options: [
                            { label: 'Ja, wie spreche ich damit?', value: 'deep_prompts_senior' },
                            { label: 'Nein, anderes Thema.', value: 'restart_topics' }
                        ]}
                    ]
                },
                deep_prompts_senior: {
                    messages: [
                        { sender: 'gast', text: 'Wie rede ich denn am besten mit dem Ger√§t?' },
                        { sender: 'marco', text: 'Stellen Sie sich vor, der Computer ist ein sehr eifriger Praktikant.' },
                        { sender: 'marco', text: '1. Geben Sie ihm eine Rolle ("Du bist ein Koch").\\n2. Sagen Sie genau, was Sie wollen ("Ein Rezept mit Kartoffeln").\\n3. Sagen Sie, was Sie NICHT wollen ("Kein Fleisch").' },
                        { sender: 'marco', text: 'Ich habe daf√ºr extra einen Bereich auf der Webseite. Schauen Sie mal hier bei den <a href="/ki/prompts.html" target="_blank">Prompts f√ºr den Alltag</a> vorbei.' },
                        { type: 'options', options: [
                            { label: 'Zur√ºck zur Auswahl', value: 'restart_topics' },
                            { label: 'Danke, Tsch√ºss', value: 'end' }
                        ]}
                    ]
                },
                risks: {
                    messages: [
                        { sender: 'gast', text: 'Man h√∂rt so viel Schlechtes in den Nachrichten. Enkeltrick und so.' },
                        { sender: 'marco', text: 'Das ist leider ein sehr wichtiger Punkt. Wir nennen das **Enkeltrick 2.0**.' },
                        { sender: 'marco', text: 'Betr√ºger k√∂nnen mit KI Stimmen aus kurzen Videos klonen. Wenn Sie einen Anruf bekommen ("Oma, ich hatte einen Unfall, ich brauche Geld"), und die Stimme klingt ECHT ‚Äì seien Sie trotzdem skeptisch!' },
                        { sender: 'marco', text: 'Mein goldener Rat: Legen Sie auf. Rufen Sie Ihren Enkel unter der Nummer an, die SIE gespeichert haben. Oder fragen Sie etwas, das nur der echte Enkel wei√ü.' },
                        { sender: 'marco', text: 'KI erfindet auch manchmal Fakten ("Halluzinationen"). Fragen Sie die KI nie nach medizinischem Rat ohne Arzt!' },
                        { type: 'options', options: [
                            { label: 'Verstanden.', value: 'restart_topics' }
                        ]}
                    ]
                }
            }
        },
        adult: {
            name: "Berufst√§tig",
            greeting: [
                { sender: 'marco', text: 'Hi! Willkommen im Update f√ºr dein Arbeitsleben. üöÄ' },
                { sender: 'marco', text: 'Denk bei KI an einen hochintelligenten **Assistenten oder Praktikanten**, der 24/7 wach ist.' },
                { sender: 'marco', text: 'Er liest 1000 Seiten in Sekunden, kann programmieren und texten ‚Äì macht aber auch mal Fl√ºchtigkeitsfehler, wenn du nicht dr√ºberschaust.' },
                { sender: 'marco', text: 'Lass uns keine Zeit verschwenden. Was bringt dich weiter?' },
                { type: 'options', options: [
                    { label: 'Excel-Hilfe & Office', value: 'office' },
                    { label: 'Bewerbungen & Lebenslauf', value: 'job_application' },
                    { label: 'Werde ich ersetzt?', value: 'jobs' },
                    { label: 'Tools f√ºr den Job', value: 'tools' }
                ]}
            ],
            topics: {
                office: {
                    messages: [
                        { sender: 'marco', text: 'K√§mpfst du mit Excel?' },
                        { type: 'options', options: [
                            { label: 'Ja, Formeln nerven.', value: 'office_excel_deep' },
                            { label: 'Nein, eher Texte/Mails.', value: 'office_mails' }
                        ]}
                    ]
                },
                office_excel_deep: {
                    messages: [
                        { sender: 'marco', text: 'Kopiere deine Spalten-Namen in die KI und sag: "Erstelle eine Formel, die X berechnet". Es funktioniert magisch.' },
                        { sender: 'marco', text: 'Beispiel: "Ich habe Spalte A (Datum) und B (Umsatz). Gib mir eine Formel f√ºr die Summe pro Monat."' },
                        { type: 'options', options: [
                            { label: 'Cool, noch was?', value: 'restart_topics' },
                            { label: 'Danke, reicht.', value: 'end' }
                        ]}
                    ]
                },
                office_mails: {
                    messages: [
                        { sender: 'marco', text: 'Du schreibst eine w√ºtende E-Mail? Sag der KI: "Formuliere das h√∂flich und diplomatisch um." Das rettet Beziehungen! üòâ' },
                        { sender: 'marco', text: 'Stell dir vor: Du hast ein langes Meeting-Protokoll. KI fasst es in 3 Bulletpoints zusammen.' },
                        { type: 'options', options: [
                            { label: 'Zur√ºck zur Auswahl', value: 'restart_topics' }
                        ]}
                    ]
                },
                job_application: {
                    messages: [
                        { sender: 'marco', text: 'KI kann deinen Lebenslauf optimieren oder Anschreiben formulieren.' },
                        { sender: 'marco', text: 'Soll ich dir einen Prompt f√ºr ein Anschreiben zeigen?' },
                        { type: 'options', options: [
                            { label: 'Ja, zeig mal.', value: 'job_prompt' },
                            { label: 'Nein.', value: 'restart_topics' }
                        ]}
                    ]
                },
                job_prompt: {
                    messages: [
                        { sender: 'marco', text: 'Hier ein Profi-Prompt:' },
                        { sender: 'marco', text: '"Du bist ein HR-Experte. Ich bewerbe mich als [JOB] bei [FIRMA]. Hier ist mein Lebenslauf: [TEXT]. Schreibe ein motivierendes Anschreiben, das auf die Werte der Firma eingeht."' },
                        { sender: 'marco', text: 'Wichtig: Immer Korrektur lesen! Die KI neigt zu √úbertreibungen.' },
                        { type: 'options', options: [
                            { label: 'Zur√ºck zur Auswahl', value: 'restart_topics' },
                            { label: 'Danke.', value: 'end' }
                        ]}
                    ]
                },
                jobs: {
                    messages: [
                        { sender: 'gast', text: 'Ganz ehrlich: Kostet mich das meinen Job?' },
                        { sender: 'marco', text: 'Der Spruch, der in der Branche gilt, ist: **"KI ersetzt keine Menschen. Aber Menschen mit KI ersetzen Menschen ohne KI."**' },
                        { sender: 'marco', text: 'Routineaufgaben fallen weg. Das ist gut! Du hast mehr Zeit f√ºr Strategie, Empathie und komplexe Probleme.' },
                        { sender: 'marco', text: 'Aber: Du musst lernen, die KI zu bedienen ("Prompting") und die Ergebnisse zu bewerten. Wer sich verweigert, wird abgeh√§ngt.' },
                        { sender: 'marco', text: 'Wichtig: Gib NIEMALS Firmengeheimnisse in ein √∂ffentliches ChatGPT ein! Das trainiert damit. Nutze Enterprise-Versionen.' },
                        { type: 'options', options: [
                            { label: 'Verstanden.', value: 'restart_topics' }
                        ]}
                    ]
                },
                tools: {
                    messages: [
                        { sender: 'gast', text: 'Welche Tools sind "Enterprise Ready" oder n√ºtzlich?' },
                        { sender: 'marco', text: 'F√ºr Office-Nutzer: **Microsoft Copilot** (ist in Word/Excel integriert).' },
                        { sender: 'marco', text: 'F√ºr Recherche: **Perplexity** (gibt Quellen an).' },
                        { sender: 'marco', text: 'F√ºr Texte/Code: **Claude** oder **ChatGPT**.' },
                        { sender: 'marco', text: 'Check meine kuratierte Liste f√ºr Profis: <a href="/ki/tools.html" target="_blank">Zur Tool-√úbersicht</a>.' },
                        { type: 'options', options: [
                            { label: 'Zur√ºck zur Auswahl', value: 'restart_topics' }
                        ]}
                    ]
                }
            }
        },
        youth: {
            name: "Jugend & Schule",
            greeting: [
                { sender: 'marco', text: 'Yo! ‚úåÔ∏è Cool, dass du am Start bist.' },
                { sender: 'marco', text: 'KI ist wie ein **NPC in einem Game**, der pl√∂tzlich alles wei√ü. Oder eine ultra-krasse Autokorrektur f√ºr dein Leben.' },
                { sender: 'marco', text: 'Es √§ndert alles: Schule, Gaming, Social Media, Coding. Checken wir\'s ab.' },
                { sender: 'marco', text: 'Was ist dein Thema?' },
                { type: 'options', options: [
                    { label: 'Coding & Gaming', value: 'gaming' },
                    { label: 'Dating & Social', value: 'dating' },
                    { label: 'Schule & Hausaufgaben', value: 'school' },
                    { label: 'Fake Influencer', value: 'fakes' }
                ]}
            ],
            topics: {
                gaming: {
                    messages: [
                        { sender: 'marco', text: 'Willst du Python lernen oder direkt ein Spiel bauen?' },
                        { type: 'options', options: [
                            { label: 'Spiel bauen', value: 'gaming_build' },
                            { label: 'Lernen', value: 'gaming_learn' }
                        ]}
                    ]
                },
                gaming_build: {
                    messages: [
                        { sender: 'marco', text: 'Nice! Ich empfehle dir **Cursor** (ein Code-Editor mit KI) + Godot oder Unity.' },
                        { sender: 'marco', text: 'Du kannst der KI sagen: "Schreib mir ein Skript f√ºr eine Spielfigur, die springen kann". Und copy-paste es.' },
                        { type: 'options', options: [
                            { label: 'Nice, noch was?', value: 'restart_topics' },
                            { label: 'Bin raus, ciao.', value: 'end' }
                        ]}
                    ]
                },
                gaming_learn: {
                    messages: [
                        { sender: 'marco', text: 'Bester Weg: Nutze ChatGPT als Tutor.' },
                        { sender: 'marco', text: 'Prompt: "Erkl√§r mir die While-Schleife in Python wie einem Anf√§nger mit Beispielen aus Minecraft".' },
                        { type: 'options', options: [
                            { label: 'Cool, zur√ºck.', value: 'restart_topics' }
                        ]}
                    ]
                },
                dating: {
                    messages: [
                        { sender: 'marco', text: 'Kleiner Tipp unter Freunden: Nutze KI f√ºr deine Bio-Texte auf Insta oder Tinder.' },
                        { sender: 'marco', text: 'Aber: **Lass dir nicht deine Chat-Antworten schreiben.**' },
                        { sender: 'marco', text: 'Das kommt raus, wirkt roboterhaft und ist cringe. üòâ Sei du selbst.' },
                        { type: 'options', options: [
                            { label: 'Check ich. Zur√ºck.', value: 'restart_topics' }
                        ]}
                    ]
                },
                school: {
                    messages: [
                        { sender: 'gast', text: 'Kann ich damit meine Hausaufgaben machen? üòÖ' },
                        { sender: 'marco', text: 'Klar KANNST du. Aber Lehrer sind auch nicht bl√∂d (und haben KI-Detektoren, auch wenn die oft failen).' },
                        { sender: 'marco', text: 'Der Hack ist: Lass die Hausaufgaben nicht SCHREIBEN, sondern ERKL√ÑREN.' },
                        { sender: 'marco', text: 'Prompt: "Ich kapiere Photosynthese nicht. Erkl√§re es mir wie einem 10-J√§hrigen mit Minecraft-Vergleichen." ‚Äì Das bleibt im Kopf!' },
                        { sender: 'marco', text: 'Wenn du nur Copy-Paste machst, f√§llst du in der Klausur auf die Nase, weil dein Gehirn leer bleibt.' },
                        { type: 'options', options: [
                            { label: 'Alles klar.', value: 'restart_topics' }
                        ]}
                    ]
                },
                fakes: {
                    messages: [
                        { sender: 'gast', text: 'Was geht auf Social Media ab? Ist da alles fake?' },
                        { sender: 'marco', text: 'Vieles. Es gibt Influencer, die gar nicht existieren (KI-generiert). Sie sehen perfekt aus, sind aber Pixel.' },
                        { sender: 'marco', text: 'Gef√§hrlich sind Deepfakes: Jemand nimmt ein Foto/Video von dir und l√§sst dich Dinge sagen, die du nie gesagt hast. Oder zieht dich digital aus.' },
                        { sender: 'marco', text: 'Regel Nr. 1: Traue keinem Bild und keinem Audio mehr blind. Check die Quelle.' },
                        { type: 'options', options: [
                            { label: 'Heftig. Zur√ºck.', value: 'restart_topics' }
                        ]}
                    ]
                }
            }
        },
        skeptic: {
            name: "Skeptiker",
            greeting: [
                { sender: 'marco', text: 'Guten Tag. Ich merke schon, Sie sind nicht hier f√ºr den Hype. Gut so. Kritisch bleiben ist wichtig.' },
                { sender: 'marco', text: 'Lassen wir die Magie weg: KI ist **Statistik, keine Zauberei**. Ein Wahrscheinlichkeits-Rechner f√ºr Worte.' },
                { sender: 'marco', text: 'Es gibt berechtigte Kritikpunkte. Lassen Sie uns Fakten diskutieren.' },
                { sender: 'marco', text: 'Welcher Aspekt macht Ihnen Sorgen?' },
                { type: 'options', options: [
                    { label: 'Copyright & Diebstahl', value: 'privacy' },
                    { label: 'Lokale KI (Datenschutz)', value: 'local_ai' },
                    { label: 'Halluzinationen & L√ºgen', value: 'hallucinations' },
                    { label: 'Energie & Umwelt', value: 'energy' }
                ]}
            ],
            topics: {
                privacy: {
                    messages: [
                        { sender: 'gast', text: 'Die klauen doch Bilder von K√ºnstlern.' },
                        { sender: 'marco', text: 'Das ist die "Fair Use" Debatte. In den USA erlaubt, in der EU (AI Act) strenger.' },
                        { sender: 'marco', text: 'M√∂chten Sie wissen, wie man K√ºnstler sch√ºtzt?' },
                        { type: 'options', options: [
                            { label: 'Ja, Schutz-Tools?', value: 'privacy_protect' },
                            { label: 'Nein, anderes Thema.', value: 'restart_topics' }
                        ]}
                    ]
                },
                privacy_protect: {
                    messages: [
                        { sender: 'marco', text: 'Es gibt Tools wie **Glaze** oder **Nightshade**.' },
                        { sender: 'marco', text: 'Die legen einen f√ºr Menschen unsichtbaren Schleier √ºber das Bild, der die KI verwirrt. So kann das Bild nicht zum Training genutzt werden.' },
                        { type: 'options', options: [
                            { label: 'Interessant. Zur√ºck.', value: 'restart_topics' },
                            { label: 'Danke, Ende.', value: 'end' }
                        ]}
                    ]
                },
                local_ai: {
                    messages: [
                        { sender: 'marco', text: 'Trauen Sie der Cloud nicht?' },
                        { type: 'options', options: [
                            { label: 'Nein, kein Vertrauen.', value: 'local_ai_deep' },
                            { label: 'Geht so.', value: 'restart_topics' }
                        ]}
                    ]
                },
                local_ai_deep: {
                    messages: [
                        { sender: 'marco', text: 'Dann schauen Sie sich **LM Studio** an. Damit l√§uft die KI nur auf Ihrem PC. Kein Internet n√∂tig.' },
                        { sender: 'marco', text: 'Es ist langsamer, aber 100% privat. Keine Daten verlassen Ihr Haus.' },
                        { type: 'options', options: [
                            { label: 'Gut zu wissen. Zur√ºck.', value: 'restart_topics' }
                        ]}
                    ]
                },
                hallucinations: {
                    messages: [
                        { sender: 'gast', text: 'Das Ding l√ºgt doch st√§ndig. Warum soll ich das nutzen?' },
                        { sender: 'marco', text: 'Korrekt. Man nennt es "Halluzinieren". Da die KI kein Weltwissen hat, sondern nur Wortfolgen berechnet, erfindet sie plausibel klingende Fakten.' },
                        { sender: 'marco', text: 'Die L√∂sung: Nutzen Sie KI nicht als Lexikon ("Wann wurde Goethe geboren?"), sondern als Sprachmotor ("Fasse diesen Text zusammen", "Formuliere das um").' },
                        { sender: 'marco', text: 'F√ºr Fakten brauchen Sie Tools mit Live-Suche (wie Perplexity), die Quellen angeben.' },
                        { type: 'options', options: [
                            { label: 'Verstanden. Zur√ºck.', value: 'restart_topics' }
                        ]}
                    ]
                },
                energy: {
                    messages: [
                        { sender: 'gast', text: 'Und der Energieverbrauch? Die Rechenzentren fressen Strom ohne Ende.' },
                        { sender: 'marco', text: 'Ein absolut valider Punkt. Ein KI-Bild zu generieren verbraucht etwa so viel Strom wie eine volle Smartphone-Ladung.' },
                        { sender: 'marco', text: 'Eine Google-Suche mit KI braucht 10x mehr Strom als eine normale Suche.' },
                        { sender: 'marco', text: 'Man muss abw√§gen: Nutze ich es f√ºr Spielereien (Katzenbilder) oder um Prozesse effizienter zu machen, die sonst noch mehr Ressourcen (Reisen, Papier) kosten w√ºrden? Nutzen Sie es bewusst.' },
                        { type: 'options', options: [
                            { label: 'Guter Punkt. Zur√ºck.', value: 'restart_topics' }
                        ]}
                    ]
                }
            }
        }
    };

    let activePersona = null;
    let messageQueue = [];
    let isProcessing = false;
    let chatBody = document.getElementById('chat-body');
    let typingIndicator = document.getElementById('typing-indicator');

    // UI Logic
    function selectPersona(personaKey) {
        activePersona = PERSONAS[personaKey];

        // Hide overlay
        document.getElementById('persona-overlay').style.display = 'none';

        // Start Chat
        messageQueue = [...activePersona.greeting];
        processQueue();
    }

    function restartChat() {
        // Clear Chat
        chatBody.innerHTML = '';
        messageQueue = [];
        isProcessing = false;
        clearTimeout(window.chatTimeout);
        typingIndicator.classList.remove('visible');

        // Show Overlay
        document.getElementById('persona-overlay').style.display = 'flex';
    }

    function addMessage(msgObj) {
        const msgDiv = document.createElement('div');
        msgDiv.className = `message ${msgObj.sender}`;

        // Format Text (Bold)
        let formattedText = msgObj.text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');

        let contentHtml = `<span class="message-content">${formattedText}</span>`;
        contentHtml += `<span class="message-time">${new Date().toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' })}</span>`;

        msgDiv.innerHTML = contentHtml;
        chatBody.appendChild(msgDiv);
        chatBody.scrollTop = chatBody.scrollHeight;
    }

    function addOptions(options) {
        const container = document.createElement('div');
        container.className = 'options-container';

        options.forEach(opt => {
            const chip = document.createElement('button');
            chip.className = 'option-chip';
            chip.textContent = opt.label;
            chip.onclick = () => handleOptionClick(opt.value, opt.label, container);
            container.appendChild(chip);
        });

        chatBody.appendChild(container);
        chatBody.scrollTop = chatBody.scrollHeight;
    }

        function handleOptionClick(value, label, container) {
        // Remove options after selection to prevent multi-clicks
        container.remove();

        // Add user choice as message
        addMessage({ sender: 'gast', text: label });

        // Load new topic messages
        if (activePersona.topics[value]) {
            const newMessages = activePersona.topics[value].messages;
            messageQueue = [...newMessages];

            // Check if the last message is options. If not, append generic options.
            const lastMsg = messageQueue[messageQueue.length - 1];
            if (!lastMsg || lastMsg.type !== 'options') {
                // Append "Anything else?" options at the end
                messageQueue.push({ sender: 'marco', text: 'M√∂chtest du noch etwas anderes wissen?' });
                messageQueue.push({ type: 'options', options: [
                    { label: 'Zur√ºck zur Auswahl', value: 'restart_topics' },
                    { label: 'Danke, reicht erstmal.', value: 'end' }
                ]});
            }

            processQueue();
        } else if (value === 'restart_topics') {
             // Re-show initial options
             const greetingOptions = activePersona.greeting.find(m => m.type === 'options');
             if (greetingOptions) {
                 messageQueue = [greetingOptions];
                 processQueue();
             }
        } else if (value === 'end') {
             messageQueue = [{ sender: 'marco', text: 'Alles klar! Viel Erfolg beim Ausprobieren. üëã' }];
             processQueue();
        }
    }

    function processQueue() {
        if (messageQueue.length === 0) {
            isProcessing = false;
            return;
        }

        isProcessing = true;
        const item = messageQueue.shift();

        if (item.type === 'options') {
            addOptions(item.options);
            isProcessing = false;
            return;
        }

        // It's a message
        let delay = 600 + (item.text.length * 15);
        if (item.sender === 'gast') delay = 400; // User messages appear faster

        if (item.sender === 'marco') {
            typingIndicator.classList.add('visible');
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        window.chatTimeout = setTimeout(() => {
            typingIndicator.classList.remove('visible');
            addMessage(item);

            // Next message
            window.chatTimeout = setTimeout(processQueue, 500); // Small pause between messages
        }, delay);
    }
  </script>
</body>
</html>
