<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="icon" type="image/png" href="/ws.png" sizes="32x32">
  <link rel="apple-touch-icon" href="/ws.png" sizes="180x180">
  <meta name="theme-color" content="#ffffff">
  <title>KI-Versteher: Adaptiver Chat-Simulator - Warenschmiede</title>
  <meta name="description" content="Simulierter KI-Chat, der sich an dich anpasst. Erkl√§rungen f√ºr Einsteiger, Berufst√§tige, Sch√ºler und Skeptiker.">
  <link rel="preload" as="image" href="/assets/logo.svg">
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="/assets/print.css?v=1.0.7" media="print">

  <style>
    /* Chat Specific Styles */
    .chat-container {
        max-width: 600px;
        width: 100%;
        margin: 0 auto;
        background: #efeae2;
        border-radius: 20px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        overflow: hidden;
        border: 1px solid #ddd;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        display: flex;
        flex-direction: column;
        height: 75vh;
        max-height: 800px;
        min-height: 500px;
        position: relative;
    }

    /* WhatsApp Background Pattern simulation */
    .chat-body {
        flex: 1;
        overflow-y: auto;
        padding: 20px 15px;
        display: flex;
        flex-direction: column;
        gap: 8px;
        background-color: #efeae2;
        background-image: radial-gradient(#d4d0c8 1px, transparent 1px);
        background-size: 20px 20px;
        scroll-behavior: smooth;
    }

    .chat-header {
        background: #008069;
        color: white;
        padding: 10px 15px;
        display: flex;
        align-items: center;
        gap: 12px;
        position: sticky;
        top: 0;
        z-index: 10;
        box-shadow: 0 1px 2px rgba(0,0,0,0.15);
    }

    .chat-header-avatar {
        width: 42px;
        height: 42px;
        border-radius: 50%;
        background: #fff;
        overflow: hidden;
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
    }
    
    .chat-header-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .chat-header-info {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .chat-header-name {
        font-weight: 600;
        font-size: 1.05rem;
        line-height: 1.2;
    }

    .chat-header-status {
        font-size: 0.8rem;
        opacity: 0.85;
        line-height: 1.2;
    }
    
    .status-dot {
        height: 8px;
        width: 8px;
        background-color: #25D366; /* WhatsApp Green bright */
        border-radius: 50%;
        display: inline-block;
        margin-left: 5px;
        box-shadow: 0 0 0 1px rgba(255,255,255,0.2);
        animation: pulse-green 2s infinite;
    }
    
    @keyframes pulse-green {
        0% { box-shadow: 0 0 0 0 rgba(37, 211, 102, 0.7); }
        70% { box-shadow: 0 0 0 6px rgba(37, 211, 102, 0); }
        100% { box-shadow: 0 0 0 0 rgba(37, 211, 102, 0); }
    }

    .message {
        max-width: 85%;
        padding: 8px 12px;
        border-radius: 7.5px;
        position: relative;
        font-size: 0.95rem;
        line-height: 1.4;
        box-shadow: 0 1px 0.5px rgba(0,0,0,0.13);
        opacity: 0;
        transform: translateY(10px);
        animation: messageAppear 0.3s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        word-wrap: break-word;
    }

    @keyframes messageAppear {
        to { opacity: 1; transform: translateY(0); }
    }

    .message.host { /* Marco */
        align-self: flex-start;
        background: #ffffff;
        border-top-left-radius: 0;
        color: #111b21;
    }

    .message.guest { /* User */
        align-self: flex-end;
        background: #d9fdd3;
        border-top-right-radius: 0;
        color: #111b21;
    }

    .message a {
        color: #027eb5;
        text-decoration: none;
        font-weight: 500;
    }
    .message a:hover {
        text-decoration: underline;
    }

    /* Typing Indicator */
    .typing-indicator {
        background: #ffffff;
        padding: 10px 15px;
        border-radius: 18px;
        border-top-left-radius: 0;
        display: none; /* Hidden by default */
        align-items: center;
        gap: 4px;
        align-self: flex-start;
        margin-left: 15px;
        margin-bottom: 10px;
        box-shadow: 0 1px 0.5px rgba(0,0,0,0.13);
        width: fit-content;
    }

    .typing-indicator.visible {
        display: inline-flex;
    }

    .dot {
        width: 6px;
        height: 6px;
        background: #b0b0b0;
        border-radius: 50%;
        animation: typingBounce 1.4s infinite ease-in-out both;
    }
    .dot:nth-child(1) { animation-delay: -0.32s; }
    .dot:nth-child(2) { animation-delay: -0.16s; }

    @keyframes typingBounce {
        0%, 80%, 100% { transform: scale(0); }
        40% { transform: scale(1); }
    }

    /* Controls & Overlay */
    .chat-controls {
        background: #f0f2f5;
        padding: 10px;
        display: flex;
        justify-content: center;
        gap: 10px;
        border-top: 1px solid #ddd;
        flex-wrap: wrap;
    }

    .chat-btn {
        background: #fff;
        border: 1px solid #ccc;
        border-radius: 24px;
        padding: 8px 16px;
        cursor: pointer;
        font-size: 0.9rem;
        color: #111b21;
        transition: all 0.2s;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .chat-btn:hover { background: #e9edef; }

    /* Persona Overlay */
    .persona-overlay {
        position: absolute;
        top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(255,255,255,0.95);
        z-index: 20;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
        text-align: center;
        backdrop-filter: blur(5px);
    }

    .persona-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        width: 100%;
        max-width: 400px;
        margin-top: 20px;
    }

    .persona-card {
        background: white;
        border: 1px solid #ddd;
        border-radius: 12px;
        padding: 15px;
        cursor: pointer;
        transition: all 0.2s;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }
    .persona-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        border-color: #008069;
    }
    .persona-icon { font-size: 2rem; display: block; margin-bottom: 5px; }
    .persona-title { font-weight: bold; font-size: 0.9rem; color: #111b21; }
    .persona-desc { font-size: 0.75rem; color: #54656f; }

    /* Dark Mode Overrides */
    html[data-theme="dark"] .chat-container {
        background: #0b141a;
        border-color: #333;
    }
    html[data-theme="dark"] .chat-body {
        background-color: #0b141a;
        background-image: radial-gradient(#2a3942 1px, transparent 1px);
    }
    html[data-theme="dark"] .chat-header {
        background: #202c33;
    }
    html[data-theme="dark"] .message.host {
        background: #202c33;
        color: #e9edef;
    }
    html[data-theme="dark"] .message.guest {
        background: #005c4b;
        color: #e9edef;
    }
    html[data-theme="dark"] .chat-controls {
        background: #202c33;
        border-color: #333;
    }
    html[data-theme="dark"] .chat-btn {
        background: #2a3942;
        border-color: #444;
        color: #e9edef;
    }
    html[data-theme="dark"] .persona-overlay {
        background: rgba(11, 20, 26, 0.95);
    }
    html[data-theme="dark"] .persona-card {
        background: #202c33;
        border-color: #333;
    }
    html[data-theme="dark"] .persona-title { color: #e9edef; }
    html[data-theme="dark"] .persona-desc { color: #8696a0; }
    html[data-theme="dark"] .message a { color: #53bdeb; }
  </style>
  <script src="/assets/js/theme.js"></script>
</head>
<body>
  <header class="site-header" data-header>
    <div class="ws-nav-container header-grid">
      <div class="brand">
        <a class="brand-link" href="../index.html#start">
          <img src="../assets/images/warenschmiede_logo.png" alt="Warenschmiede Logo" class="brand-logo" width="453" height="276">
          <div class="brand-text">
            <span class="brand-name">Warenschmiede</span>
            <span class="brand-tagline">3D-Druck ¬∑ Made in Germany</span>
          </div>
        </a>
      </div>

      <nav class="main-nav" aria-label="Hauptnavigation">
        <div class="nav-menu" id="primary-navigation" data-nav-menu>
          <ul class="nav-list" id="navList">
            <li class="nav-item nav-fixed">
              <a class="nav-link" href="../index.html#start"><span class="nav-ico" aria-hidden="true">üè†</span>Start</a>
            </li>

            <li class="nav-item nav-fixed">
              <a class="nav-link" href="../downloads.html"><span class="nav-ico" aria-hidden="true">üì•</span>Downloads</a>
            </li>

            <li class="nav-item nav-fixed nav-more nav-dropdown nav-tools" data-nav-dropdown>
              <button class="nav-more-btn" type="button" aria-haspopup="true" aria-expanded="false">
                <span class="nav-ico" aria-hidden="true">üßÆ</span>Online Tools ‚ñæ
              </button>
              <ul class="nav-more-menu" hidden>
                <li><a class="nav-link" href="../tools/"><span class="nav-ico" aria-hidden="true">üóÇÔ∏è</span>Tool-√úbersicht</a></li>
                <li><a class="nav-link" href="../werkstatt-rechner.html"><span class="nav-ico" aria-hidden="true">üõ†Ô∏è</span>Warenschmiede METALL</a></li>
                <li><a class="nav-link" href="../tools/kostenrechner-v2.html"><span class="nav-ico" aria-hidden="true">üßÆ</span>3D-Druck Rechner</a></li>
              </ul>
            </li>

            <li class="nav-item nav-fixed nav-more nav-dropdown nav-services" data-nav-dropdown>
              <button class="nav-more-btn" type="button" aria-haspopup="true" aria-expanded="false"><span class="nav-ico" aria-hidden="true">üß∞</span>Leistungen ‚ñæ</button>
              <ul class="nav-more-menu" hidden>
                <li><a class="nav-link" href="../leistungen/3d-druck.html"><span class="nav-ico" aria-hidden="true">üì¶</span>3D-Druckauftrag</a></li>
                <li><a class="nav-link" href="../leistungen/cad-prototyping.html"><span class="nav-ico" aria-hidden="true">üìê</span>CAD &amp; Prototyping</a></li>
                <li><a class="nav-link" href="../leistungen/pc-hilfe.html"><span class="nav-ico" aria-hidden="true">üíª</span>PC-Hilfe</a></li>
              </ul>
            </li>

            <li class="nav-item nav-fixed nav-more nav-dropdown" data-nav-dropdown>
              <button class="nav-more-btn" type="button" aria-haspopup="true" aria-expanded="false"><span class="nav-ico" aria-hidden="true">ü§ñ</span>√úber KI ‚ñæ</button>
              <ul class="nav-more-menu" hidden>
                <li><a class="nav-link" href="chat.html" aria-current="page" style="color: var(--accent); font-weight: bold;"><span class="nav-ico" aria-hidden="true">üí¨</span>KI-Versteher (Neu)</a></li>
                <li><a class="nav-link" href="index.html"><span class="nav-ico" aria-hidden="true">üìñ</span>Einf√ºhrung &amp; Grundlagen</a></li>
                <li><a class="nav-link" href="prompts.html"><span class="nav-ico" aria-hidden="true">‚úçÔ∏è</span>Prompts f√ºr den Alltag</a></li>
                <li><a class="nav-link" href="promt-trainer.html"><span class="nav-ico" aria-hidden="true">üß†</span>KI Trainer</a></li>
                <li><a class="nav-link" href="ki-finder.html"><span class="nav-ico" aria-hidden="true">üß≠</span>Warenschmiede KI-Finder</a></li>
                <li><a class="nav-link" href="tools.html"><span class="nav-ico" aria-hidden="true">üõ†Ô∏è</span>KI-Werkzeuge</a></li>
                <li><a class="nav-link" href="so-arbeitest-du-mit-ki.html"><span class="nav-ico" aria-hidden="true">üß≠</span>So arbeitest du mit KI</a></li>
                <li><a class="nav-link" href="programme-die-du-brauchst.html"><span class="nav-ico" aria-hidden="true">üíæ</span>Software-Tipps</a></li>
                <li><a class="nav-link" href="chancen-und-risiken.html"><span class="nav-ico" aria-hidden="true">‚öñÔ∏è</span>Chancen &amp; Risiken</a></li>
                <li><a class="nav-link" href="faq.html"><span class="nav-ico" aria-hidden="true">üîí</span>FAQ &amp; Sicherheit</a></li>
              </ul>
            </li>

            <li class="nav-item nav-fixed nav-more nav-dropdown nav-contact" data-nav-dropdown>
              <button class="nav-more-btn" type="button" aria-haspopup="true" aria-expanded="false"><span class="nav-ico" aria-hidden="true">‚úâÔ∏è</span>Kontakt ‚ñæ</button>
              <ul class="nav-more-menu" hidden>
                <li><a class="nav-link" href="../kontakt.html"><span class="nav-ico" aria-hidden="true">üìß</span>Kontakt aufnehmen</a></li>
                <li><a class="nav-link" href="../ablauf-anfrage.html"><span class="nav-ico" aria-hidden="true">üìù</span>Ablauf &amp; Anfrage</a></li>
                <li><a class="nav-link" href="../ueber-mich.html"><span class="nav-ico" aria-hidden="true">üë§</span>√úber mich</a></li>
              </ul>
            </li>

            <li class="nav-item nav-fixed nav-more nav-dropdown nav-3d" data-nav-dropdown>
              <button class="nav-more-btn" type="button" aria-haspopup="true" aria-expanded="false"><span class="nav-ico" aria-hidden="true">üì¶</span>3D-Druck ‚ñæ</button>
              <ul class="nav-more-menu" hidden>
                <li><a class="nav-link" href="../3ddruck-chat.html"><span class="nav-ico" aria-hidden="true">üí¨</span>Interaktiver Berater</a></li>
                <li><a class="nav-link" href="../technologien.html"><span class="nav-ico" aria-hidden="true">üß™</span>Technologien</a></li>
                <li><a class="nav-link" href="../fehlerdatenbank.html"><span class="nav-ico" aria-hidden="true">üõ†Ô∏è</span>Fehler &amp; L√∂sungen</a></li>
                <li><a class="nav-link" href="../material.html"><span class="nav-ico" aria-hidden="true">üìö</span>Material-Guide</a></li>
                <li><a class="nav-link" href="../druck-tipps.html"><span class="nav-ico" aria-hidden="true">üß≠</span>Tipps &amp; Kosten</a></li>
                <li><a class="nav-link" href="../3ddruck-faq.html"><span class="nav-ico" aria-hidden="true">‚ùì</span>FAQ</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>

      <div class="header-actions">
        <button class="theme-toggle" type="button" id="themeToggleBtn" aria-label="Design umschalten">
          <span id="themeIcon" aria-hidden="true">üñ•Ô∏è</span>
          <span class="theme-toggle__text" id="themeToggleText">Helles Design</span>
        </button>

        <button class="nav-toggle" type="button" aria-controls="primary-navigation" aria-expanded="false" data-nav-toggle>
          <span class="sr-only">Men√º √∂ffnen</span>
          <span class="nav-toggle-bar" aria-hidden="true"></span>
          <span class="nav-toggle-bar" aria-hidden="true"></span>
          <span class="nav-toggle-bar" aria-hidden="true"></span>
        </button>
      </div>
    </div>
  </header>

  <main class="site-main">
    <div class="container">
        <div class="ws-section" style="text-align: center;">
            <h1 class="ws-page-title">KI-Versteher</h1>
            <p style="color: var(--text-muted); max-width: 600px; margin: 0 auto;">
                W√§hle deinen Modus und entdecke, was K√ºnstliche Intelligenz f√ºr dich bedeutet.
            </p>
        </div>

        <div class="chat-container">
            <div class="chat-header">
                <div class="chat-header-avatar">
                     <img src="/assets/img/marco.jpg" alt="Marco" onerror="this.src='/assets/img/avatar-placeholder.svg'">
                </div>
                <div class="chat-header-info">
                    <div class="chat-header-name">Marco (KI-Guide)</div>
                    <div class="chat-header-status">Online</div>
                </div>
            </div>

            <div class="chat-body" id="chat-body">
                </div>

            <div class="typing-indicator" id="typing-indicator">
                <div class="dot"></div><div class="dot"></div><div class="dot"></div>
            </div>

            <div class="persona-overlay" id="persona-overlay">
                <h3>KI einfach erkl√§rt.<br>Wer fragt gerade?</h3>
                <div class="persona-grid">
                    <div class="persona-card" onclick="selectPersona('senior')">
                        <span class="persona-icon">üë¥</span>
                        <div class="persona-title">Senior / Einsteiger</div>
                        <div class="persona-desc">Einfach & Sicher</div>
                    </div>
                    <div class="persona-card" onclick="selectPersona('adult')">
                        <span class="persona-icon">üë®‚Äçüíº</span>
                        <div class="persona-title">Beruf & Alltag</div>
                        <div class="persona-desc">Effizient & Praxis</div>
                    </div>
                    <div class="persona-card" onclick="selectPersona('youth')">
                        <span class="persona-icon">üéÆ</span>
                        <div class="persona-title">Jugend & Schule</div>
                        <div class="persona-desc">Locker & Future</div>
                    </div>
                    <div class="persona-card" onclick="selectPersona('skeptic')">
                        <span class="persona-icon">ü§®</span>
                        <div class="persona-title">Skeptiker</div>
                        <div class="persona-desc">Kritisch & Fakten</div>
                    </div>
                </div>
            </div>

            <div class="chat-controls">
                <button class="chat-btn" onclick="restartChat()">üîÑ Neustart / Wechseln</button>
            </div>
        </div>

        <div style="text-align: center; margin-top: 2rem; margin-bottom: 4rem;">
            <p style="color: var(--text-muted); font-size: 0.9rem;">
                Hinweis: Dies ist ein simulierter Chat. Alle Links √∂ffnen in einem neuen Tab.
            </p>
            <a href="/ki/tools.html" class="btn btn-primary">Alle KI-Tools ansehen</a>
        </div>
    </div>
  </main>

  <script src="../assets/js/theme.js"></script>
  <script src="../assets/js/header.js"></script>

  <script>
    // --- KONFIGURATION & DATEN ---
    
    const PERSONAS = {
        senior: {
            name: "Senior",
            greeting: [
                { sender: 'marco', text: 'Hallo! üëã Sch√∂n, dass Sie sich trauen. Keine Sorge, wir gehen das ganz entspannt an.' },
                { sender: 'marco', text: 'Stellen Sie sich KI wie einen sehr belesenen **Bibliothekar** vor. üìö' },
                { sender: 'marco', text: 'Er hat alle B√ºcher der Welt gelesen, aber er "versteht" den Inhalt nicht wie ein Mensch. Er r√§t statistisch, welches Wort als n√§chstes kommt.' },
                { sender: 'marco', text: 'Was liegt Ihnen auf dem Herzen?' },
                { type: 'options', options: [
                    { label: 'Wie bediene ich das?', value: 'basics' },
                    { label: 'Reisen & Sprachen', value: 'travel' },
                    { label: 'Damals & Heute üï∞Ô∏è', value: 'history' },
                    { label: 'Geschenk-Ideen üéÅ', value: 'gifts' },
                    { label: 'Ist das sicher (Enkeltrick)?', value: 'risks' },
                    { label: 'Gesundheit (Vorsicht)', value: 'health' },
                    { label: 'Zeig mir Programme', value: 'tools' },
                    { label: 'Sprechen & √úbersetzen', value: 'voice_translator' }
                ]}
            ],
            topics: {
                voice_translator: {
                    messages: [
                        { sender: 'marco', text: 'Tippen ist m√ºhsam. Wussten Sie, dass Sie mit dem Handy sprechen k√∂nnen wie mit einem Menschen?' },
                        { sender: 'marco', text: 'Im Urlaub ist das Gold wert: Handy auf den Tisch legen, "Dolmetscher-Modus" an.' },
                        { sender: 'marco', text: 'Sie sprechen Deutsch, das Handy spricht Italienisch. Der Kellner antwortet Italienisch, das Handy sagt es Ihnen auf Deutsch. Live!' }
                    ]
                },
                basics: {
                    messages: [
                        { sender: 'gast', text: 'Muss ich programmieren lernen?' },
                        { sender: 'marco', text: 'Nein! Sie steuern diese Programme mit ganz normaler Sprache.' },
                        { sender: 'marco', text: 'Schreiben Sie wie in einem Brief oder einer WhatsApp an die Familie.' },
                        { sender: 'marco', text: 'Beispiel: "Schreibe ein Gedicht f√ºr den 80. Geburtstag meiner Schwester Helga, sie mag Gartenarbeit."' }
                    ]
                },
                travel: {
                    messages: [
                        { sender: 'gast', text: 'Kann mir das im Urlaub helfen?' },
                        { sender: 'marco', text: 'Oh ja! Installieren Sie ChatGPT oder Google Translate auf dem Handy.' },
                        { sender: 'marco', text: 'Sie k√∂nnen deutsch hineinsprechen, und das Handy spricht den Satz sofort in Spanisch oder Italienisch aus.' },
                        { sender: 'marco', text: 'Soll ich ein Beispiel simulieren?' },
                        { type: 'options', options: [
                            { label: 'Ja, gerne!', value: 'travel_demo' },
                            { label: 'Nein, weiter.', value: 'restart_topics' }
                        ]}
                    ]
                },
                history: {
                    messages: [
                        { sender: 'marco', text: 'Schwelgen Sie gerne in Erinnerungen? Fragen Sie: "Was waren die Top-Schlager im Jahr 1965?" oder "Was kostete Brot 1970?".' },
                        { sender: 'marco', text: 'Das ist wie eine Zeitreise auf Knopfdruck.' }
                    ]
                },
                gifts: {
                    messages: [
                        { sender: 'marco', text: 'Keine Idee f√ºr die Enkel? Beschreiben Sie das Enkelkind (Alter, Hobbys) und die KI liefert 10 perfekte Ideen.' }
                    ]
                },
                travel_demo: {
                    messages: [
                        { sender: 'marco', text: 'Okay, stellen Sie sich vor, Sie sind in Spanien in der Apotheke.' },
                        { sender: 'marco', text: 'Sie sagen: "Wo ist die n√§chste Apotheke?"' },
                        { sender: 'marco', text: 'Das Handy sagt laut: **"¬øD√≥nde est√° la farmacia m√°s cercana?"**' },
                        { sender: 'marco', text: 'Das nimmt die Angst vor fremden Sprachen!' }
                    ]
                },
                health: {
                    messages: [
                        { sender: 'gast', text: 'Kann ich die KI nach Medizin fragen?' },
                        { sender: 'marco', text: '‚ö†Ô∏è Bitte seien Sie da sehr vorsichtig!' },
                        { sender: 'marco', text: 'KI ist kein Arzt. Sie kann allgemeine Tipps geben ("Was hilft bei Wadenkrampf?"), aber sie erfindet manchmal Fakten.' },
                        { sender: 'marco', text: 'Vertrauen Sie bei Gesundheit immer echten Menschen und √Ñrzten, nicht dem Chatbot.' }
                    ]
                },
                risks: {
                    messages: [
                        { sender: 'gast', text: 'Man h√∂rt so viel vom Enkeltrick.' },
                        { sender: 'marco', text: 'Wichtiges Thema! Betr√ºger k√∂nnen Stimmen mit KI klonen.' },
                        { sender: 'marco', text: 'Wenn ein Anruf kommt ("Oma, ich brauche Geld"), legen Sie auf und rufen Sie den Enkel unter der Nummer an, die SIE gespeichert haben.' }
                    ]
                },
                tools: {
                    messages: [
                        { sender: 'gast', text: 'Wo finde ich das?' },
                        { sender: 'marco', text: 'Die meisten Basis-Versionen sind kostenlos.' },
                        { sender: 'marco', text: 'Ich habe eine Liste erstellt: <a href="/ki/tools.html" target="_blank">Zu meiner Werkzeug-√úbersicht</a>.' }
                    ]
                }
            }
        },
        adult: {
            name: "Berufst√§tig",
            greeting: [
                { sender: 'marco', text: 'Hi! Willkommen im Update f√ºr dein Arbeitsleben. üöÄ' },
                { sender: 'marco', text: 'Denk bei KI an einen hochintelligenten **Assistenten**, der 24/7 wach ist.' },
                { sender: 'marco', text: 'Lass uns keine Zeit verschwenden. Was bringt dich weiter?' },
                { type: 'options', options: [
                    { label: 'Excel & Office', value: 'office' },
                    { label: 'Bewerbung & Karriere', value: 'career' },
                    { label: 'Kochen & Reste üç≥', value: 'cooking' },
                    { label: 'Reise-Planung ‚úàÔ∏è', value: 'travel_pro' },
                    { label: 'Werde ich ersetzt?', value: 'jobs' },
                    { label: 'Tools f√ºr den Job', value: 'tools' },
                    { label: 'KI kann sehen? (Vision)', value: 'vision_help' }
                ]}
            ],
            topics: {
                vision_help: {
                    messages: [
                        { sender: 'marco', text: 'Das wissen die wenigsten: Du kannst der KI Fotos zeigen!' },
                        { sender: 'marco', text: 'Beispiel 1: Dein Kaktus wird braun? Foto machen -> "Was fehlt ihm?" -> Diagnose.' },
                        { sender: 'marco', text: 'Beispiel 2: Foto vom Sicherungskasten -> "Welcher Schalter ist f√ºr den Herd?".' },
                        { sender: 'marco', text: 'Das Feature hei√üt "Vision" und ist in GPT-4o oder Google Lens drin.' }
                    ]
                },
                office: {
                    messages: [
                        { sender: 'gast', text: 'Ich k√§mpfe oft mit Excel-Formeln...' },
                        { sender: 'marco', text: 'Das ist der perfekte Einsatzzweck!' },
                        { sender: 'marco', text: 'Kopiere einfach deine Spaltennamen in die KI und schreib: "Erstelle eine Formel, die Spalte A mit B vergleicht und Rot markiert, wenn..."' },
                        { sender: 'marco', text: 'Das spart Stunden an Arbeit.' }
                    ]
                },
                career: {
                    messages: [
                        { sender: 'gast', text: 'Kann die KI meinen Lebenslauf schreiben?' },
                        { sender: 'marco', text: 'Sie kann ihn extrem verbessern.' },
                        { sender: 'marco', text: 'Kopiere deinen alten Lebenslauf rein und sag: "Optimiere das f√ºr eine Stelle als Projektmanager. Mach es pr√§gnanter."' },
                        { sender: 'marco', text: 'Aber: Das Foto und die pers√∂nlichen Daten machst du bitte selbst! üòâ' }
                    ]
                },
                cooking: {
                    messages: [
                        { sender: 'marco', text: 'Das nutze ich st√§ndig! Mach ein Foto von deinem offenen K√ºhlschrank (oder schreib, was drin ist).' },
                        { sender: 'marco', text: 'Sag: "Was kann ich daraus kochen?". Du kriegst sofort Rezepte. Nie wieder Lebensmittel wegwerfen!' }
                    ]
                },
                travel_pro: {
                    messages: [
                        { sender: 'marco', text: 'Planst du einen Trip? Sag: "Erstelle eine 7-Tage-Route f√ºr Japan, Fokus auf Tech und Essen. Budget mittel".' },
                        { sender: 'marco', text: 'Die KI liefert dir Hotels, Z√ºge und Sehensw√ºrdigkeiten.' }
                    ]
                },
                jobs: {
                    messages: [
                        { sender: 'gast', text: 'Kostet mich das meinen Job?' },
                        { sender: 'marco', text: 'Der Spruch der Branche ist: **"KI ersetzt keine Menschen. Aber Menschen mit KI ersetzen Menschen ohne KI."**' },
                        { sender: 'marco', text: 'Wer lernt, die Tools zu nutzen, wird produktiver und wertvoller. Wer sich verweigert, wird es schwer haben.' }
                    ]
                },
                tools: {
                    messages: [
                        { sender: 'gast', text: 'Welche Tools sind "Enterprise Ready"?' },
                        { sender: 'marco', text: 'Microsoft Copilot ist oft schon in Office drin. F√ºr Recherche ist Perplexity top.' },
                        { sender: 'marco', text: 'Hier ist meine Liste: <a href="/ki/tools.html" target="_blank">Zur Tool-√úbersicht</a>.' }
                    ]
                }
            }
        },
        youth: {
            name: "Jugend & Schule",
            greeting: [
                { sender: 'marco', text: 'Yo! ‚úåÔ∏è KI ist wie ein **NPC**, der pl√∂tzlich alles wei√ü.' },
                { sender: 'marco', text: 'Was ist dein Thema?' },
                { type: 'options', options: [
                    { label: 'Schule & Hausaufgaben', value: 'school' },
                    { label: 'Gaming & Coding', value: 'gaming' },
                    { label: 'Dating & Rizz üíò', value: 'love_rizz' },
                    { label: 'Gym & Fitness üí™', value: 'fitness' },
                    { label: 'Fake Influencer', value: 'fakes' },
                    { label: 'Krasse Tools', value: 'tools' },
                    { label: 'Bilder generieren', value: 'gen_images' }
                ]}
            ],
            topics: {
                gen_images: {
                    messages: [
                        { sender: 'marco', text: 'Vergiss Google Bilder. Du kannst dir Bilder *bauen* lassen.' },
                        { sender: 'marco', text: 'Prompt: "Ein Astronaut reitet auf einem T-Rex im Weltraum, Cyberpunk Style". Zack, hast du ein Unikat.' },
                        { sender: 'marco', text: 'Tools daf√ºr: Midjourney (Discord), DALL-E (in ChatGPT) oder Flux (gratis).' }
                    ]
                },
                school: {
                    messages: [
                        { sender: 'gast', text: 'Kann ich damit Hausaufgaben machen? üòÖ' },
                        { sender: 'marco', text: 'Klar KANNST du. Aber Lehrer checken das inzwischen.' },
                        { sender: 'marco', text: 'Der Hack ist: Lass die Hausaufgaben nicht SCHREIBEN, sondern ERKL√ÑREN.' },
                        { sender: 'marco', text: 'Prompt: "Erkl√§re mir Photosynthese mit Minecraft-Vergleichen." ‚Äì Das bleibt im Kopf!' }
                    ]
                },
                gaming: {
                    messages: [
                        { sender: 'gast', text: 'Was geht bei Gaming?' },
                        { sender: 'marco', text: 'Willst du ein Spiel bauen?' },
                        { type: 'options', options: [
                            { label: 'Ja, programmieren!', value: 'coding_deep' },
                            { label: 'Nein, nur zocken.', value: 'gaming_general' }
                        ]}
                    ]
                },
                love_rizz: {
                    messages: [
                        { sender: 'marco', text: 'Okay, Romeo. üòÑ KI kann dir helfen, coole Opener zu schreiben.' },
                        { sender: 'marco', text: 'Aber warnung: Kopier es nicht blind. Wenn du klingst wie ein Dichter aus dem 18. Jahrhundert, kriegst du einen Korb.' },
                        { sender: 'marco', text: 'Besser: "Schreib eine lustige Nachricht an jemanden, der gerne Anime mag".' }
                    ]
                },
                fitness: {
                    messages: [
                        { sender: 'marco', text: 'Dein Personal Trainer! Sag der KI: "Ich bin 1,80m, wiege 70kg und will Muskeln aufbauen. Mach mir einen 3-Tages-Plan f√ºr Zuhause".' }
                    ]
                },
                coding_deep: {
                    messages: [
                        { sender: 'marco', text: 'Nice! Dann hol dir **Cursor** oder nutze ChatGPT.' },
                        { sender: 'marco', text: 'Sag einfach: "Schreib mir ein Snake-Spiel in Python". Die KI gibt dir den Code und erkl√§rt, wie du ihn startest.' }
                    ]
                },
                gaming_general: {
                    messages: [
                        { sender: 'marco', text: 'Auch gut. In Zukunft werden NPCs in Games viel schlauer sein und echte Gespr√§che mit dir f√ºhren, dank KI.' }
                    ]
                },
                fakes: {
                    messages: [
                        { sender: 'gast', text: 'Ist auf Social Media alles fake?' },
                        { sender: 'marco', text: 'Vieles. Es gibt Influencer, die nur Pixel sind.' },
                        { sender: 'marco', text: 'Glaube keinem Bild und keiner Stimme mehr blind. Check immer die Quelle.' }
                    ]
                },
                tools: {
                    messages: [
                        { sender: 'gast', text: 'Was gibt es Cooles?' },
                        { sender: 'marco', text: 'Bilder (Midjourney), Musik (Suno)... check meine Liste: <a href="/ki/tools.html" target="_blank">Zu den KI-Tools</a>' }
                    ]
                }
            }
        },
        skeptic: {
            name: "Skeptiker",
            greeting: [
                { sender: 'marco', text: 'Guten Tag. Gut, dass Sie kritisch bleiben.' },
                { sender: 'marco', text: 'KI ist **Statistik, keine Magie**. Ein Wahrscheinlichkeits-Rechner f√ºr Worte.' },
                { sender: 'marco', text: 'Lassen Sie uns Fakten diskutieren.' },
                { type: 'options', options: [
                    { label: 'Halluzinationen (L√ºgen)', value: 'hallucinations' },
                    { label: 'Hat KI Vorurteile? ‚öñÔ∏è', value: 'bias' },
                    { label: 'Urheberrecht & Klauen', value: 'privacy' },
                    { label: 'Energie & Umwelt', value: 'energy' },
                    { label: 'Lokale KI (Datenschutz)', value: 'local_ai' }
                ]}
            ],
            topics: {
                hallucinations: {
                    messages: [
                        { sender: 'gast', text: 'Das Ding erz√§hlt doch oft Unsinn.' },
                        { sender: 'marco', text: 'Korrekt. Man nennt es "Halluzinieren".' },
                        { sender: 'marco', text: 'Nutzen Sie KI nie als Lexikon ("Wann wurde X geboren?"), sondern als Sprach-Motor ("Formuliere diesen Text um").' }
                    ]
                },
                bias: {
                    messages: [
                        { sender: 'marco', text: 'Exzellente Frage. Ja, hat sie.' },
                        { sender: 'marco', text: 'Die KI lernt aus dem Internet. Und im Internet gibt es Vorurteile. Wenn die Daten "biased" sind, ist es die KI auch.' },
                        { sender: 'marco', text: 'Firmen arbeiten hart an "Filtern", aber man muss sich dessen bewusst sein.' }
                    ]
                },
                privacy: {
                    messages: [
                        { sender: 'gast', text: 'Die klauen doch Bilder von K√ºnstlern.' },
                        { sender: 'marco', text: 'Ein hei√ües Eisen. Ja, die Modelle wurden mit Daten aus dem Internet trainiert.' },
                        { sender: 'marco', text: 'Es gibt Tools wie "Glaze", mit denen K√ºnstler ihre Werke vor KI sch√ºtzen k√∂nnen.' }
                    ]
                },
                local_ai: {
                    messages: [
                        { sender: 'marco', text: 'Dann schauen Sie sich unbedingt **LM Studio** an.' },
                        { sender: 'marco', text: 'Damit laden Sie die "Gehirne" (Modelle) herunter und lassen sie komplett offline auf Ihrem eigenen PC laufen. Kein Internet n√∂tig, keine Daten verlassen das Haus.' },
                        { type: 'options', options: [
                            { label: 'Brauche ich einen Super-Computer?', value: 'local_ai_hardware' },
                            { label: 'Klingt gut. Wo gibt\'s das?', value: 'local_ai_link' }
                        ]}
                    ]
                },
                local_ai_hardware: {
                    messages: [
                        { sender: 'marco', text: 'Jein. Ein normaler Gaming-PC (mit Nvidia Grafikkarte) ist optimal.' },
                        { sender: 'marco', text: 'Aber moderne MacBooks (M1/M2/M3) sind auch fantastisch daf√ºr.' },
                        { sender: 'marco', text: 'F√ºr reine Text-KI reicht sogar ein guter Mittelklasse-Laptop. Es l√§uft dann nur etwas langsamer.' },
                        { type: 'options', options: [
                            { label: 'Okay, wo finde ich das?', value: 'local_ai_link' }
                        ]}
                    ]
                },
                local_ai_link: {
                    messages: [
                        { sender: 'marco', text: 'Das Tool ist kostenlos. Sie k√∂nnen es hier herunterladen: <a href="https://lmstudio.ai/" target="_blank">LM Studio Website</a>.' },
                        { sender: 'marco', text: 'Tipp: Suchen Sie dort nach "Llama 3" oder "Mistral". Das sind tolle Einsteiger-Modelle.' },
                        { type: 'options', options: [
                            { label: 'Danke, schau ich mir an.', value: 'end' },
                            { label: 'Zur√ºck zur Auswahl', value: 'restart_topics' }
                        ]}
                    ]
                },
                energy: {
                    messages: [
                        { sender: 'gast', text: 'Und der Stromverbrauch?' },
                        { sender: 'marco', text: 'Riesig. Ein KI-Bild kostet so viel Strom wie eine Handy-Ladung.' },
                        { sender: 'marco', text: 'Man sollte es bewusst nutzen, nicht f√ºr jeden Quatsch.' }
                    ]
                }
            }
        }
    };

    // --- LOGIK (ENGINE) ---
    
    let activePersona = null;
    let messageQueue = [];
    let isProcessing = false;
    let currentTimeout = null;

    const overlay = document.getElementById('persona-overlay');
    const chatBody = document.getElementById('chat-body');
    const typingIndicator = document.getElementById('typing-indicator');

    // 1. Start: Persona ausw√§hlen
    function selectPersona(type) {
        activePersona = PERSONAS[type];
        
        // UI anpassen
        overlay.style.display = 'none'; // Overlay ausblenden
        document.querySelector('.chat-header-name').innerHTML = 'Marco (Guide) f√ºr: ' + activePersona.name + ' <span class="status-dot"></span>';

        // Begr√º√üung laden
        // Wir klonen das Array, damit wir das Original nicht ver√§ndern
        messageQueue = [...activePersona.greeting];
        processQueue();
    }

    // 2. Queue abarbeiten (Nachricht f√ºr Nachricht)
    function processQueue() {
        if (messageQueue.length === 0) {
            isProcessing = false;
            return;
        }

        isProcessing = true;
        const item = messageQueue.shift(); // Erstes Element holen

        if (item.type === 'options') {
            // Wenn es Buttons sind -> Anzeigen und warten
            showOptions(item.options);
            isProcessing = false; 
            return;
        }

        // Wenn es eine Text-Nachricht ist -> Anzeigen mit Verz√∂gerung
        showTyping();
        
        // Berechne Lesegeschwindigkeit (l√§ngerer Text = l√§ngere Pause)
        let delay = 600 + (item.text.length * 15);
        if (item.sender === 'gast') delay = 500; // Gast tippt schneller

        currentTimeout = setTimeout(() => {
            hideTyping();
            addMessageToChat(item);
            
            // Kleine Pause nach der Nachricht, dann weiter in der Queue
            currentTimeout = setTimeout(processQueue, 400); 
        }, delay);
    }

    // 3. Nachricht ins HTML einf√ºgen
    function addMessageToChat(msg) {
        const div = document.createElement('div');
        div.className = `message ${msg.sender === 'marco' ? 'host' : 'guest'}`;
        // Markdown Bold zu HTML Bold
        let txt = msg.text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        div.innerHTML = txt; 
        chatBody.appendChild(div);
        scrollToBottom();
    }

    // 4. Buttons anzeigen
    function showOptions(options) {
        const div = document.createElement('div');
        div.className = 'chat-controls';
        
        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'chat-btn';
            btn.innerText = opt.label;
            btn.onclick = () => handleOptionClick(opt.value, opt.label, div);
            div.appendChild(btn);
        });

        chatBody.appendChild(div);
        scrollToBottom();
    }

    // 5. Klick auf eine Option
    function handleOptionClick(value, label, controlsDiv) {
        // Buttons entfernen/deaktivieren (damit man nicht nochmal klickt)
        controlsDiv.remove();
        
        // Anzeigen was der User geklickt hat (als Gast-Nachricht)
        addMessageToChat({ sender: 'gast', text: label });

        // Spezialfall: Neustart der Themen
        if (value === 'restart_topics') {
            // Suche das Greeting-Option-Objekt wieder raus
            const greetingOptions = activePersona.greeting.find(m => m.type === 'options');
            if (greetingOptions) {
                messageQueue = [greetingOptions];
                processQueue();
            }
            return;
        }

        // Normalfall: Thema laden
        if (activePersona.topics[value]) {
            const topicData = activePersona.topics[value];
            
            // Falls das Topic 'messages' hat (neues Format)
            if (topicData.messages) {
                 messageQueue = [...topicData.messages];
            } else {
                // Fallback
                messageQueue = [...topicData];
            }
            
            // Check ob am Ende Options kommen, sonst "Alles klar" anh√§ngen
            const lastMsg = messageQueue[messageQueue.length - 1];
            if (!lastMsg || lastMsg.type !== 'options') {
                 messageQueue.push({ type: 'options', options: [
                    { label: 'Anderes Thema', value: 'restart_topics' }
                 ]});
            }
            
            processQueue();
        }
    }

    // Hilfsfunktionen
    function showTyping() {
        typingIndicator.classList.add('visible');
        scrollToBottom();
    }

    function hideTyping() {
        typingIndicator.classList.remove('visible');
    }

    function scrollToBottom() {
        chatBody.scrollTop = chatBody.scrollHeight;
    }
    
    // Neustart (Reload Page)
    function restartChat() {
        location.reload();
    }
  </script>
</body>
</html>